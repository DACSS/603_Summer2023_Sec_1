<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bryn Kruzlic">
<meta name="dcterms.date" content="2023-08-18">

<title>Kruzlic Class Project 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Kruzlic Class Project 2">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://dacss.github.io/603_Summer2023_Sec_1/posts/KruzlicClass_Project2_files/figure-html/unnamed-chunk-7-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Summer2023_Sec_1/" rel="" target="">
 <span class="menu-text">Summer 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Summer2023_Sec_1/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#these-are-the-libraries-being-used-in-the-following-project." id="toc-these-are-the-libraries-being-used-in-the-following-project." class="nav-link active" data-scroll-target="#these-are-the-libraries-being-used-in-the-following-project.">These are the libraries being used in the following project.</a></li>
  <li><a href="#cleaning-up-the-data" id="toc-cleaning-up-the-data" class="nav-link" data-scroll-target="#cleaning-up-the-data">Cleaning up the data</a></li>
  <li><a href="#grouping-and-analysis--defining-and-representing-variables" id="toc-grouping-and-analysis--defining-and-representing-variables" class="nav-link" data-scroll-target="#grouping-and-analysis--defining-and-representing-variables">Grouping and Analysis- Defining and Representing Variables</a>
  <ul class="collapse">
  <li><a href="#top-artists" id="toc-top-artists" class="nav-link" data-scroll-target="#top-artists"><em>Top Artists</em></a></li>
  <li><a href="#song-duration" id="toc-song-duration" class="nav-link" data-scroll-target="#song-duration"><em>Song Duration</em></a></li>
  <li><a href="#most-and-least-popular-songs" id="toc-most-and-least-popular-songs" class="nav-link" data-scroll-target="#most-and-least-popular-songs"><em>Most and Least Popular Songs</em></a></li>
  <li><a href="#plot-pdf-and-cdf" id="toc-plot-pdf-and-cdf" class="nav-link" data-scroll-target="#plot-pdf-and-cdf"><em>Plot PDF and CDF</em></a></li>
  </ul></li>
  <li><a href="#variable-defining-and-redefining" id="toc-variable-defining-and-redefining" class="nav-link" data-scroll-target="#variable-defining-and-redefining">Variable Defining and Redefining</a>
  <ul class="collapse">
  <li><a href="#standard-errors" id="toc-standard-errors" class="nav-link" data-scroll-target="#standard-errors"><em>Standard Errors</em></a></li>
  <li><a href="#generating-plots" id="toc-generating-plots" class="nav-link" data-scroll-target="#generating-plots"><em>Generating Plots</em></a></li>
  </ul></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis">Regression Analysis</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations">Correlations</a></li>
  <li><a href="#customize-variable-models" id="toc-customize-variable-models" class="nav-link" data-scroll-target="#customize-variable-models">Customize Variable Models</a></li>
  <li><a href="#plot-observations" id="toc-plot-observations" class="nav-link" data-scroll-target="#plot-observations">Plot Observations</a>
  <ul class="collapse">
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1"><em>Model 1:</em></a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2"><em>Model 2:</em></a></li>
  <li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3"><em>Model 3:</em></a></li>
  </ul></li>
  <li><a href="#finding-the-best-model-specifications" id="toc-finding-the-best-model-specifications" class="nav-link" data-scroll-target="#finding-the-best-model-specifications">Finding the Best Model Specifications</a>
  <ul class="collapse">
  <li><a href="#checking-for-multicollinearity-in-the-following-models" id="toc-checking-for-multicollinearity-in-the-following-models" class="nav-link" data-scroll-target="#checking-for-multicollinearity-in-the-following-models"><em>Checking for multicollinearity in the following models:</em></a></li>
  <li><a href="#obtaining-robust-standard-errors-and-stargazer" id="toc-obtaining-robust-standard-errors-and-stargazer" class="nav-link" data-scroll-target="#obtaining-robust-standard-errors-and-stargazer">Obtaining Robust Standard Errors and Stargazer</a></li>
  <li><a href="#linear-hypothesis-testing" id="toc-linear-hypothesis-testing" class="nav-link" data-scroll-target="#linear-hypothesis-testing">Linear Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#written-explanations-what-do-we-see-here" id="toc-written-explanations-what-do-we-see-here" class="nav-link" data-scroll-target="#written-explanations-what-do-we-see-here">Written explanations: What do we see here?</a></li>
  <li><a href="#citations" id="toc-citations" class="nav-link" data-scroll-target="#citations">Citations</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Kruzlic Class Project 2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final project 2</div>
    <div class="quarto-category">Qasim Abbas</div>
    <div class="quarto-category">dplyr</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bryn Kruzlic </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="these-are-the-libraries-being-used-in-the-following-project." class="level1">
<h1>These are the libraries being used in the following project.</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'AER' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'

The following object is masked from 'package:dplyr':

    recode

The following object is masked from 'package:purrr':

    some

Loading required package: lmtest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lmtest' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'zoo' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sandwich' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:survival':

    cluster

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dummy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>dummy 0.1.3
dummyNews()</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: 

 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.
 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glmnet' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loaded glmnet 4.1-7</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-up-the-data" class="level1">
<h1>Cleaning up the data</h1>
<section id="unfortunately-this-dataset-does-contain-a-fair-amount-of-missing-data-in-addition-to-more-measures-of-music-than-we-need.-for-this-project-we-are-only-focused-on-genre-dur-duration-and-pop-popularity-when-it-comes-to-the-top-spotify-charting-songs-from-2010-to-2019.-the-below-code-features-the-cleaning-process-merging-together-different-subgenres-into-one-umbrella-genre-eliminating-repeat-values-and-omitting-nas." class="level5">
<h5 class="anchored" data-anchor-id="unfortunately-this-dataset-does-contain-a-fair-amount-of-missing-data-in-addition-to-more-measures-of-music-than-we-need.-for-this-project-we-are-only-focused-on-genre-dur-duration-and-pop-popularity-when-it-comes-to-the-top-spotify-charting-songs-from-2010-to-2019.-the-below-code-features-the-cleaning-process-merging-together-different-subgenres-into-one-umbrella-genre-eliminating-repeat-values-and-omitting-nas.">Unfortunately, this dataset does contain a fair amount of missing data in addition to more measures of music than we need. For this project, we are only focused on genre, dur (duration) and pop (popularity) when it comes to the Top Spotify charting songs from 2010 to 2019. The below code features the cleaning process, merging together different subgenres into one ‘umbrella’ genre, eliminating repeat values and omitting NAs.</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in dataset</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/Bryn Kruzlic/OneDrive/Desktop/MS_DACSS/DACSS603/top10s.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 603 Columns: 15
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(3): title, artist, top genre dbl (12): ...1, year, bpm, nrgy, dnce, dB, live,
val, dur, acous, spch, pop
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(top10s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering NAs from the dataset</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>top10s <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_all</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bpm <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>           nrgy <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>           dnce <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>           dB <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>           live <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>           dur <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>           spch <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>           pop  <span class="sc">==</span> <span class="dv">0</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 15
   ...1 title artist `top genre`  year   bpm  nrgy  dnce    dB  live   val   dur
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    51 Hello Marti… big room     2010   128    98    67    -3    10    45   191
2   139 Blow… P!nk   dance pop    2012   114    92    60    -3    25    75   256
3   268 Not … Justi… dance pop    2014    86    73    59    -6    38    46   266
4   363 L.A.… Fergie dance pop    2015   202    39    48    -8    26    27   193
5   443 Mill… Adele  british so…  2016     0     0     0   -60     0     0   227
# ℹ 3 more variables: acous &lt;dbl&gt;, spch &lt;dbl&gt;, pop &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(top10s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      ...1          title              artist           top genre        
 Min.   :  1.0   Length:603         Length:603         Length:603        
 1st Qu.:151.5   Class :character   Class :character   Class :character  
 Median :302.0   Mode  :character   Mode  :character   Mode  :character  
 Mean   :302.0                                                           
 3rd Qu.:452.5                                                           
 Max.   :603.0                                                           
      year           bpm             nrgy           dnce      
 Min.   :2010   Min.   :  0.0   Min.   : 0.0   Min.   : 0.00  
 1st Qu.:2013   1st Qu.:100.0   1st Qu.:61.0   1st Qu.:57.00  
 Median :2015   Median :120.0   Median :74.0   Median :66.00  
 Mean   :2015   Mean   :118.5   Mean   :70.5   Mean   :64.38  
 3rd Qu.:2017   3rd Qu.:129.0   3rd Qu.:82.0   3rd Qu.:73.00  
 Max.   :2019   Max.   :206.0   Max.   :98.0   Max.   :97.00  
       dB               live            val             dur       
 Min.   :-60.000   Min.   : 0.00   Min.   : 0.00   Min.   :134.0  
 1st Qu.: -6.000   1st Qu.: 9.00   1st Qu.:35.00   1st Qu.:202.0  
 Median : -5.000   Median :12.00   Median :52.00   Median :221.0  
 Mean   : -5.579   Mean   :17.77   Mean   :52.23   Mean   :224.7  
 3rd Qu.: -4.000   3rd Qu.:24.00   3rd Qu.:69.00   3rd Qu.:239.5  
 Max.   : -2.000   Max.   :74.00   Max.   :98.00   Max.   :424.0  
     acous            spch             pop       
 Min.   : 0.00   Min.   : 0.000   Min.   : 0.00  
 1st Qu.: 2.00   1st Qu.: 4.000   1st Qu.:60.00  
 Median : 6.00   Median : 5.000   Median :69.00  
 Mean   :14.33   Mean   : 8.358   Mean   :66.52  
 3rd Qu.:17.00   3rd Qu.: 9.000   3rd Qu.:76.00  
 Max.   :99.00   Max.   :48.000   Max.   :99.00  </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in the chart due to seperate releases</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">!=</span> <span class="st">'The Hills'</span> <span class="sc">|</span> year <span class="sc">!=</span> <span class="dv">2016</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging subgenres together for more cohesion</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> top10s[<span class="st">"top genre"</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(top10s<span class="sc">$</span><span class="st">'top genre'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "neo mellow"                "detroit hip hop"          
 [3] "dance pop"                 "pop"                      
 [5] "canadian pop"              "hip pop"                  
 [7] "barbadian pop"             "atl hip hop"              
 [9] "australian pop"            "indie pop"                
[11] "art pop"                   "colombian pop"            
[13] "big room"                  "british soul"             
[15] "chicago rap"               "acoustic pop"             
[17] "permanent wave"            "boy band"                 
[19] "baroque pop"               "celtic rock"              
[21] "electro"                   "complextro"               
[23] "canadian hip hop"          "candy pop"                
[25] "alaska indie"              "folk-pop"                 
[27] "metropopolis"              "house"                    
[29] "australian hip hop"        "electropop"               
[31] "australian dance"          "hollywood"                
[33] "canadian contemporary r&amp;b" "irish singer-songwriter"  
[35] "tropical house"            "belgian edm"              
[37] "french indie pop"          "hip hop"                  
[39] "danish pop"                "latin"                    
[41] "canadian latin"            "electronic trap"          
[43] "edm"                       "electro house"            
[45] "downtempo"                 "brostep"                  
[47] "contemporary country"      "moroccan pop"             
[49] "escape room"               "alternative r&amp;b"          </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">separate</span>((<span class="st">`</span><span class="at">top genre</span><span class="st">`</span>),<span class="fu">c</span>(<span class="st">"variable"</span>,<span class="st">"genre"</span>),<span class="at">extra=</span><span class="st">'merge'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 97 rows [5, 12, 24, 55,
58, 60, 65, 106, 108, 110, 114, 118, 119, 138, 148, 150, 153, 155, 163, 168,
...].</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>other <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"complextro"</span>, <span class="st">"downtempo"</span>, <span class="st">"brostep"</span>, <span class="st">"electro"</span>, <span class="st">"electronic"</span>, <span class="st">"escape"</span>, <span class="st">"folk-pop"</span>, <span class="st">"hollywood"</span>, <span class="st">"house"</span>, <span class="st">"irish"</span>, <span class="st">"permanent"</span>, <span class="st">"neo"</span>, <span class="st">"metropolis"</span>, <span class="st">"tropical"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">%in%</span> other] <span class="ot">&lt;-</span> <span class="st">'other'</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'hip'</span>] <span class="ot">&lt;-</span> <span class="st">'hip hop'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'latin'</span>] <span class="ot">&lt;-</span> <span class="st">'latin'</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'boy'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'french'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'electropop'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'pop'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>genre <span class="sc">==</span> <span class="st">'contemporary r&amp;b'</span>] <span class="ot">&lt;-</span> <span class="st">'r&amp;b'</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>genre <span class="sc">==</span> <span class="st">'room'</span>] <span class="ot">&lt;-</span> <span class="st">'other'</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(top10s<span class="sc">$</span>genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
country   dance     edm hip hop   indie   latin   other     pop     r&amp;b     rap 
      1       6       2      20       1       5      46     493       9       1 
   rock    soul 
      1      11 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>miss <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(top10s))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(miss[miss<span class="sc">&gt;</span><span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>genre 
    6 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span><span class="fu">na.omit</span>(top10s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="grouping-and-analysis--defining-and-representing-variables" class="level1">
<h1>Grouping and Analysis- Defining and Representing Variables</h1>
<section id="top-artists" class="level3">
<h3 class="anchored" data-anchor-id="top-artists"><em>Top Artists</em></h3>
<section id="this-below-chart-represents-the-artists-with-the-highest-number-of-charting-songs-between-2010-and-2019." class="level5">
<h5 class="anchored" data-anchor-id="this-below-chart-represents-the-artists-with-the-highest-number-of-charting-songs-between-2010-and-2019.">This below chart represents the artists with the highest number of charting songs between 2010 and 2019.</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pop_artist <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))<span class="sc">%&gt;%</span><span class="fu">group_by</span>(artist)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>pop_artist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 596 × 16
# Groups:   artist [181]
    ...1 title   artist variable genre  year   bpm  nrgy  dnce    dB  live   val
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1   573 "Memor… Maroo… pop      pop    2019    91    32    76    -7     8    57
 2   574 "Lose … Selen… dance    pop    2019   102    34    51    -9    21     9
 3   575 "Someo… Lewis… pop      pop    2019   110    41    50    -6    11    45
 4   576 "Se\xf… Shawn… canadian pop    2019   117    54    76    -6     9    75
 5   577 "How D… Sam S… pop      pop    2019   111    68    48    -5     8    35
 6   578 "South… Ed Sh… pop      pop    2019    98    62    86    -6     9    67
 7   579 "Tramp… SHAED  electro… pop    2019   127    46    62    -6    14    50
 8   580 "Happi… Marsh… brostep  other  2019   100    79    69    -3    17    67
 9   581 "Truth… Lizzo  escape   other  2019   158    62    72    -3    12    41
10   582 "Good … Lizzo  escape   other  2019    96    89    67    -3    74    48
# ℹ 586 more rows
# ℹ 4 more variables: dur &lt;dbl&gt;, acous &lt;dbl&gt;, spch &lt;dbl&gt;, pop &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>top_artist<span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(artist)<span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop=</span>n<span class="sc">/</span><span class="fu">sum</span>(n))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>most_popular_artist <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(artist) <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no.of.songs =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(no.of.songs)) </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>summarized_songs_artist <span class="ot">&lt;-</span> most_popular_artist <span class="sc">%&gt;%</span> </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(no.of.songs,<span class="at">n=</span><span class="dv">15</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(summarized_songs_artist)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>most_popular_artist <span class="ot">&lt;-</span> pop_artist<span class="sc">%&gt;%</span><span class="fu">count</span>(artist)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>most_popular_artist<span class="sc">%&gt;%</span><span class="fu">head</span>(<span class="dv">15</span>)<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(artist,n),<span class="at">y=</span>n))<span class="sc">+</span><span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"15 Most Popular Artists"</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="song-duration" class="level3">
<h3 class="anchored" data-anchor-id="song-duration"><em>Song Duration</em></h3>
<section id="this-below-chart-represents-the-average-duration-of-songs-by-genre.-not-surprisingly-the-majority-of-top-charting-spotify-songs-are-in-pop-with-most-of-the-songs-averaging-between-200-and-300-seconds.-this-means-that-the-majority-of-charting-pop-songs-range-from-3.5-to-5-minutes." class="level5">
<h5 class="anchored" data-anchor-id="this-below-chart-represents-the-average-duration-of-songs-by-genre.-not-surprisingly-the-majority-of-top-charting-spotify-songs-are-in-pop-with-most-of-the-songs-averaging-between-200-and-300-seconds.-this-means-that-the-majority-of-charting-pop-songs-range-from-3.5-to-5-minutes.">This below chart represents the average duration of songs by genre. Not surprisingly, the majority of top charting Spotify songs are in Pop, with most of the songs averaging between 200 and 300 seconds. This means that the majority of charting Pop songs range from 3.5 to 5 minutes.</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(genre,dur),<span class="at">y=</span>dur))<span class="sc">+</span><span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"limegreen"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Song Duration"</span>)<span class="sc">+</span><span class="fu">theme_light</span>()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>duration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, dur), <span class="at">y =</span> dur)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Song Duration"</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Genre"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Duration"</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>duration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>summarized_data_genre <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_duration =</span> <span class="fu">mean</span>(dur)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_duration))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(summarized_data_genre)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summarized_data_genre) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Song Genre"</span>, <span class="st">"Average Song Duration"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(dur_genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in view(dur_genre): object 'dur_genre' not found</code></pre>
</div>
</div>
</section>
</section>
<section id="most-and-least-popular-songs" class="level3">
<h3 class="anchored" data-anchor-id="most-and-least-popular-songs"><em>Most and Least Popular Songs</em></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>max_pop <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">filter</span>(pop<span class="sc">&gt;=</span><span class="dv">60</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(artist,pop,title,genre)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>max_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 448 × 4
   artist          pop title                                               genre
   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;                                               &lt;chr&gt;
 1 Maroon 5         99 "Memories"                                          pop  
 2 Selena Gomez     97 "Lose You To Love Me"                               pop  
 3 Lewis Capaldi    96 "Someone You Loved"                                 pop  
 4 Shawn Mendes     95 "Se\xf1orita"                                       pop  
 5 Sam Smith        93 "How Do You Sleep?"                                 pop  
 6 Ed Sheeran       92 "South of the Border (feat. Camila Cabello &amp; Cardi… pop  
 7 SHAED            92 "Trampoline (with ZAYN)"                            pop  
 8 Marshmello       90 "Happier"                                           other
 9 Lizzo            90 "Truth Hurts"                                       other
10 Lizzo            90 "Good as Hell (feat. Ariana Grande) - Remix"        other
# ℹ 438 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>min_pop <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">filter</span>(pop<span class="sc">&lt;=</span><span class="dv">59</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(artist,pop,title,genre)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>min_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 148 × 4
   artist                pop title                                         genre
   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;                                         &lt;chr&gt;
 1 Adam Lambert           59 If I Had You                                  pop  
 2 The Black Eyed Peas    59 Rock That Body                                pop  
 3 Britney Spears         59 Hold It Against Me                            pop  
 4 Jennifer Lopez         59 I'm Into You                                  pop  
 5 Pitbull                59 Don't Stop the Party (feat. TJR)              pop  
 6 Alicia Keys            59 Girl On Fire (feat. Nicki Minaj) - Inferno V… hip …
 7 Pharrell Williams      59 Come Get It Bae                               pop  
 8 Lost Frequencies       59 Reality (feat. Janieck Devy) - Radio Edit     edm  
 9 Fifth Harmony          59 Angel                                         pop  
10 Little Mix             59 Touch (feat. Kid Ink)                         pop  
# ℹ 138 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>max_pop_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(top10s<span class="sc">$</span>pop, <span class="fl">0.9</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>min_pop_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(top10s<span class="sc">$</span>pop, <span class="fl">0.1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop, <span class="at">color =</span> <span class="fu">ifelse</span>(pop <span class="sc">&gt;=</span> max_pop_threshold, <span class="st">"Max Popularity"</span>, <span class="fu">ifelse</span>(pop <span class="sc">&lt;=</span> min_pop_threshold, <span class="st">"Min Popularity"</span>, <span class="st">"Intermediate"</span>)))) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Song Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>, <span class="at">color =</span> <span class="st">"Popularity Level by Genre"</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Max Popularity"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Min Popularity"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Intermediate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-pdf-and-cdf" class="level3">
<h3 class="anchored" data-anchor-id="plot-pdf-and-cdf"><em>Plot PDF and CDF</em></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>var1_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>var1_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(var1_pdf)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>var1_pdf_cdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Genre =</span> <span class="fu">names</span>(var1_pdf), <span class="at">Probability =</span> var1_pdf, <span class="at">Cumulative =</span> var1_cdf)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var1_pdf_cdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Genre Probability.Var1 Probability.Freq  Cumulative
country country          country      0.001677852 0.001677852
dance     dance            dance      0.010067114 0.011744966
edm         edm              edm      0.003355705 0.015100671
hip hop hip hop          hip hop      0.033557047 0.048657718
indie     indie            indie      0.001677852 0.050335570
latin     latin            latin      0.008389262 0.058724832
other     other            other      0.077181208 0.135906040
pop         pop              pop      0.827181208 0.963087248
r&amp;b         r&amp;b              r&amp;b      0.015100671 0.978187919
rap         rap              rap      0.001677852 0.979865772
rock       rock             rock      0.001677852 0.981543624
soul       soul             soul      0.018456376 1.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">density</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>dur))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>var2_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>dur))</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>var2_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(var2_pdf)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>var2_pdf_cdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Duration =</span> <span class="fu">unique</span>(top10s<span class="sc">$</span>dur),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Probability =</span> var2_pdf,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cumulative =</span> var2_cdf)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(var2_pdf_cdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 144 × 4
   Duration Probability.Var1 Probability.Freq Cumulative
      &lt;dbl&gt; &lt;fct&gt;                       &lt;dbl&gt;      &lt;dbl&gt;
 1      217 134                       0.00168    0.00168
 2      263 148                       0.00168    0.00336
 3      200 157                       0.00168    0.00503
 4      295 158                       0.00168    0.00671
 5      221 159                       0.00336    0.0101 
 6      214 160                       0.00168    0.0117 
 7      203 162                       0.00168    0.0134 
 8      225 164                       0.00168    0.0151 
 9      216 166                       0.00168    0.0168 
10      235 169                       0.00336    0.0201 
# ℹ 134 more rows</code></pre>
</div>
</div>
<section id="pdf-or-probability-density-function-and-cdf-or-cumulative-distribution-function-can-help-us-understand-the-likelihood-of-a-random-variable-taking-on-a-particular-value.-in-the-example-of-spotify-chart-data-the-pdf-can-provide-insight-on-how-frequent-these-values-may-appear-and-the-cdf-can-help-us-understand-how-these-specific-features-can-impact-a-songs-relative-popularity-and-performance." class="level5">
<h5 class="anchored" data-anchor-id="pdf-or-probability-density-function-and-cdf-or-cumulative-distribution-function-can-help-us-understand-the-likelihood-of-a-random-variable-taking-on-a-particular-value.-in-the-example-of-spotify-chart-data-the-pdf-can-provide-insight-on-how-frequent-these-values-may-appear-and-the-cdf-can-help-us-understand-how-these-specific-features-can-impact-a-songs-relative-popularity-and-performance.">PDF or probability density function and CDF or cumulative distribution function can help us understand the likelihood of a random variable taking on a particular value. In the example of Spotify chart data, the PDF can provide insight on how frequent these values may appear and the CDF can help us understand how these specific features can impact a songs’ relative popularity and performance.</h5>
</section>
</section>
</section>
<section id="variable-defining-and-redefining" class="level1">
<h1>Variable Defining and Redefining</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># naming the variables</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>genre_mapping <span class="ot">&lt;-</span> <span class="fu">unique</span>(top10s<span class="sc">$</span>genre)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>variable_1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(top10s<span class="sc">$</span>genre, <span class="at">levels =</span> genre_mapping))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(variable_1) <span class="co"># genre of the popular songs</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>variable_2 <span class="ot">&lt;-</span> top10s<span class="sc">$</span>dur <span class="co"># duration of the popular songs </span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>variable_3 <span class="ot">&lt;-</span> top10s<span class="sc">$</span>pop <span class="co"># popularity score of songs; used for omitted variable bias</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>variable_1 <span class="ot">&lt;-</span> variable_1</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>variable_2 <span class="ot">&lt;-</span> variable_2</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and standard deviations</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.092282</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.427182</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224.745</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.26896</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.38255</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.53045</code></pre>
</div>
</div>
<section id="standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="standard-errors"><em>Standard Errors</em></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x)))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>sufficient_observations <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">length</span>(x) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>genre_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>genre_sample_sizes <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="generating-plots" class="level3">
<h3 class="anchored" data-anchor-id="generating-plots"><em>Generating Plots</em></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>average_duration <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> mean)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(average_duration<span class="sc">$</span>dur, <span class="at">names.arg =</span> average_duration<span class="sc">$</span>genre, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Duration"</span>, <span class="at">main =</span> <span class="st">"Average Duration by Genre"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="regression-analysis" class="level1">
<h1>Regression Analysis</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>dur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">is.na</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> top10s[<span class="sc">!</span>missing_values, ]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">main =</span> <span class="st">"Top 10s - Genre Distribution"</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">col =</span> <span class="st">"maroon"</span>, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Duration"</span>, <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">median</span>(top10s<span class="sc">$</span>dur), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>), <span class="at">main =</span> <span class="st">"Top 10s - Duration by Genre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="correlations" class="level1">
<h1>Correlations</h1>
<section id="the-graphs-below-will-allow-us-to-see-the-correlation-between-specific-variables-within-the-dataset.-for-the-purpose-of-our-research-only-the-variables-genre-dur-and-bpm-will-be-utilized." class="level5">
<h5 class="anchored" data-anchor-id="the-graphs-below-will-allow-us-to-see-the-correlation-between-specific-variables-within-the-dataset.-for-the-purpose-of-our-research-only-the-variables-genre-dur-and-bpm-will-be-utilized.">The graphs below will allow us to see the correlation between specific variables within the dataset. For the purpose of our research, only the variables “genre”, “dur” and “bpm” will be utilized.</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>bpm_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>bpm,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"BPM/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>bpm_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>bpm, top10s<span class="sc">$</span>pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02314881</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>dur_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>dur,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Duration/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>dur_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>dur, top10s<span class="sc">$</span>pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1056947</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>genre_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable_1,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Genre/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>genre_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
: pseudoinverse used at 0.945</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
: neighborhood radius 2.055</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
: reciprocal condition number 4.4549e-16</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
: There are other near singularities as well. 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
: zero-width neighborhood. make span bigger</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Computation failed in `stat_smooth()`
Caused by error in `predLoess()`:
! NA/NaN/Inf in foreign function call (arg 5)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>variable_1, top10s<span class="sc">$</span>pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01021489</code></pre>
</div>
</div>
</section>
</section>
<section id="customize-variable-models" class="level1">
<h1>Customize Variable Models</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model_genre <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> genre, <span class="at">data =</span> top10s)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>model_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> dur, <span class="at">data =</span> top10s)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2, <span class="at">data =</span> top10s) <span class="co">#multiple regression model</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept) 76.94574192 4.18664674 18.3788475 4.801203e-60
variable_1  -0.14312546 0.41598167 -0.3440667 7.309181e-01
variable_2  -0.04503152 0.01732417 -2.5993458 9.572657e-03</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> <span class="fu">log</span>(variable_1) <span class="sc">+</span> <span class="fu">log</span>(variable_2), <span class="at">data =</span> top10s) <span class="co"># log-linear model</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)     124.1855261  22.308875  5.5666423 3.938166e-08
log(variable_1)  -0.3867623   1.527494 -0.2532006 8.002009e-01
log(variable_2) -10.6205119   4.109617 -2.5843067 9.995379e-03</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> <span class="fu">I</span>(variable_1) <span class="sc">+</span> <span class="fu">I</span>(variable_2) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s) <span class="co"># high order polynomial </span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate   Std. Error    t value  Pr(&gt;|t|)
(Intercept)      6.348489e+01 5.489305e+01  1.1565198 0.2479375
I(variable_1)   -2.408607e+00 2.932493e+00 -0.8213513 0.4117785
I(variable_2)    1.506765e-01 6.501551e-01  0.2317547 0.8168091
I(variable_1^2)  7.025044e-01 6.774892e-01  1.0369234 0.3001971
I(variable_2^2) -8.068174e-04 2.486779e-03 -0.3244427 0.7457181
I(variable_1^3) -4.945496e-02 4.340270e-02 -1.1394442 0.2549811
I(variable_2^3)  1.060373e-06 3.078065e-06  0.3444935 0.7305982</code></pre>
</div>
</div>
</section>
<section id="plot-observations" class="level1">
<h1>Plot Observations</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Attempting again to omit NA values</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(top10s)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(top10s<span class="sc">$</span>genre)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>variable_1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(variable_1)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>variable_2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(variable_2)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_1)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_2)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_3)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(variable_1, variable_2)</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_for_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="model-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1"><em>Model 1:</em></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the following observations- Multiple Regression Model</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>intercept_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"(Intercept)"</span>]</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>coef_variable_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"variable_1"</span>]</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>coef_variable_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"variable_2"</span>]</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>predicted_pop_1 <span class="ot">&lt;-</span> intercept_1 <span class="sc">+</span> coef_variable_1 <span class="sc">*</span> top10s<span class="sc">$</span>variable_1 <span class="sc">+</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                 coef_variable_2 <span class="sc">*</span> top10s<span class="sc">$</span>variable_2</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> predicted_pop_1), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> predicted_pop_1), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-2" class="level2">
<h2 class="anchored" data-anchor-id="model-2"><em>Model 2:</em></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the following observations- OLS Equation</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>intercept_ols <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"(Intercept)"</span>]</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>coef_variable_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"variable_1"</span>]</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>coef_variable_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"variable_2"</span>]</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>predicted_pop_ols <span class="ot">&lt;-</span> intercept_ols <span class="sc">+</span> coef_variable_1 <span class="sc">*</span> top10s<span class="sc">$</span>variable_1 <span class="sc">+</span> coef_variable_2 <span class="sc">*</span> top10s<span class="sc">$</span>variable_2</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>na.rm <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> <span class="fu">fitted</span>(model_2)), <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> <span class="fu">fitted</span>(model_2)), <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-3" class="level2">
<h2 class="anchored" data-anchor-id="model-3"><em>Model 3:</em></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the following observations- High Order Polynomial</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>predicted_pop <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_3, <span class="at">newdata =</span> top10s)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> predicted_pop), <span class="at">color =</span> <span class="st">"maroon"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> predicted_pop), <span class="at">color =</span> <span class="st">"maroon"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="KruzlicClass_Project2_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="finding-the-best-model-specifications" class="level1">
<h1>Finding the Best Model Specifications</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating multiple specifications to find best model</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>top10s_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>top10s_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_2 <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>top10s_mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2 <span class="sc">+</span> variable_3, <span class="at">data =</span> top10s) <span class="co"># exclude from future manipulations</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>top10s_mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2 <span class="sc">+</span> bpm, <span class="at">data =</span> top10s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="checking-for-multicollinearity-in-the-following-models" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-multicollinearity-in-the-following-models"><em>Checking for multicollinearity in the following models:</em></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempting to mitigate multicollinearity in the previous models</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(top10s[, <span class="fu">c</span>(<span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>)])</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            variable_1  variable_2
variable_1  1.00000000 -0.03618429
variable_2 -0.03618429  1.00000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">### correlation value of -0.03618429 suggests that the variables are not strongly correlated.</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>vif_results_1 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_1)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>vif_results_2 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_2)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>vif_results_3 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_3)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>variable_1 variable_2 
  1.001311   1.001311 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>log(variable_1) log(variable_2) 
       1.000437        1.000437 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  I(variable_1)   I(variable_2) I(variable_1^2) I(variable_2^2) I(variable_1^3) 
       49.56246      1404.61111       359.86366      5140.77194       167.87602 
I(variable_2^3) 
     1247.37702 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">### very high variance inflation factor (VIF) for model_3, the higher order polynomial equation, signifying multicollinearity in the model. </span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>tolerance_values_1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_1</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>tolerance_values_2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_2</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>tolerance_values_3 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_3</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>variable_1 variable_2 
 0.9986907  0.9986907 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>log(variable_1) log(variable_2) 
      0.9995633       0.9995633 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  I(variable_1)   I(variable_2) I(variable_1^2) I(variable_2^2) I(variable_1^3) 
   0.0201765606    0.0007119408    0.0027788302    0.0001945233    0.0059567770 
I(variable_2^3) 
   0.0008016822 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">### very low (close to 0) score for model_3, signifying multicollinearity in the model. </span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempting to mitigate multicollinearity in the newest models</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(top10s[, <span class="fu">c</span>(<span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>, <span class="st">"pop"</span>, <span class="st">"bpm"</span>)])</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            variable_1  variable_2         pop         bpm
variable_1  1.00000000 -0.03618429 -0.01021489  0.06691989
variable_2 -0.03618429  1.00000000 -0.10569472 -0.03262715
pop        -0.01021489 -0.10569472  1.00000000  0.02314881
bpm         0.06691989 -0.03262715  0.02314881  1.00000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">### correlation value less than 1 suggest that the variables are not strongly correlated.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="obtaining-robust-standard-errors-and-stargazer" class="level2">
<h2 class="anchored" data-anchor-id="obtaining-robust-standard-errors-and-stargazer">Obtaining Robust Standard Errors and Stargazer</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>se_1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>se_2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>se_3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod3, <span class="at">type =</span> <span class="st">"HC1"</span>))) <span class="co"># 'Y' value of 'pop' within the dataset 'top10s' equates to the third variable and therefore, cannot be used. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>se_4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(top10s_mod1, top10s_mod2, top10s_mod4,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">"New Models"</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="at">type =</span> <span class="st">"latex"</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="at">se =</span> rob_se,</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="at">object.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="at">model.numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"(i)"</span>, <span class="st">"(ii)"</span>, <span class="st">"(iiii)"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
\begin{table}[!htbp] \centering 
  \caption{New Models} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}}lccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 &amp; \multicolumn{3}{c}{\textit{Dependent variable:}} \\ 
\cline{2-4} 
\\[-1.8ex] &amp; \multicolumn{3}{c}{pop} \\ 
 &amp; (i) &amp; (ii) &amp; (iiii) \\ 
\\[-1.8ex] &amp; top10s_mod1 &amp; top10s_mod2 &amp; top10s_mod4\\ 
\hline \\[-1.8ex] 
 variable\_1 &amp; $-$1.938 &amp;  &amp; $-$0.157 \\ 
  &amp; (3.354) &amp;  &amp; (0.535) \\ 
  &amp; &amp; &amp; \\ 
 I(variable\_1$\hat{\mkern6mu}$2) &amp; 0.574 &amp;  &amp;  \\ 
  &amp; (0.794) &amp;  &amp;  \\ 
  &amp; &amp; &amp; \\ 
 I(variable\_1$\hat{\mkern6mu}$3) &amp; $-$0.041 &amp;  &amp;  \\ 
  &amp; (0.054) &amp;  &amp;  \\ 
  &amp; &amp; &amp; \\ 
 variable\_2 &amp;  &amp; 0.135 &amp; $-$0.045$^{***}$ \\ 
  &amp;  &amp; (0.473) &amp; (0.015) \\ 
  &amp; &amp; &amp; \\ 
 I(variable\_2$\hat{\mkern6mu}$2) &amp;  &amp; $-$0.001 &amp;  \\ 
  &amp;  &amp; (0.002) &amp;  \\ 
  &amp; &amp; &amp; \\ 
 I(variable\_2$\hat{\mkern6mu}$3) &amp;  &amp; 0.00000 &amp;  \\ 
  &amp;  &amp; (0.00000) &amp;  \\ 
  &amp; &amp; &amp; \\ 
 bpm &amp;  &amp;  &amp; 0.012 \\ 
  &amp;  &amp;  &amp; (0.033) \\ 
  &amp; &amp; &amp; \\ 
 Constant &amp; 68.098$^{***}$ &amp; 62.304 &amp; 75.491$^{***}$ \\ 
  &amp; (4.824) &amp; (40.853) &amp; (5.380) \\ 
  &amp; &amp; &amp; \\ 
\hline \\[-1.8ex] 
Observations &amp; 596 &amp; 596 &amp; 596 \\ 
R$^{2}$ &amp; 0.002 &amp; 0.011 &amp; 0.012 \\ 
Adjusted R$^{2}$ &amp; $-$0.003 &amp; 0.006 &amp; 0.007 \\ 
Residual Std. Error (df = 592) &amp; 14.554 &amp; 14.484 &amp; 14.481 \\ 
F Statistic (df = 3; 592) &amp; 0.358 &amp; 2.274$^{*}$ &amp; 2.356$^{*}$ \\ 
\hline 
\hline \\[-1.8ex] 
\textit{Note:}  &amp; \multicolumn{3}{r}{$^{*}$p$&lt;$0.1; $^{**}$p$&lt;$0.05; $^{***}$p$&lt;$0.01} \\ 
\end{tabular} 
\end{table} </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(top10s_mod1, top10s_mod2, top10s_mod4,</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Regression Models"</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"(i)"</span>, <span class="st">"(ii)"</span>, <span class="st">"(iiii)"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression Models
===============================================================
                                     Dependent variable:       
                               --------------------------------
                                             pop               
                                  (i)        (ii)      (iiii)  
                                  (1)        (2)        (3)    
---------------------------------------------------------------
variable_1                      -1.9383               -0.1570  
                                (3.3536)              (0.5349) 
                                                               
I(variable_12)                   0.5736                        
                                (0.7939)                       
                                                               
I(variable_13)                  -0.0405                        
                                (0.0536)                       
                                                               
variable_2                                  0.1348   -0.0448***
                                           (0.4729)   (0.0155) 
                                                               
I(variable_22)                             -0.0007             
                                           (0.0018)            
                                                               
I(variable_23)                             0.000001            
                                          (0.000002)           
                                                               
bpm                                                    0.0121  
                                                      (0.0334) 
                                                               
Constant                       68.0979***  62.3041   75.4906***
                                (4.8238)  (40.8534)   (5.3800) 
                                                               
---------------------------------------------------------------
Observations                      596        596        596    
R2                               0.0018     0.0114     0.0118  
Adjusted R2                     -0.0032     0.0064     0.0068  
Residual Std. Error (df = 592)  14.5540    14.4840    14.4810  
F Statistic (df = 3; 592)        0.3577    2.2738*    2.3556*  
===============================================================
Note:                               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="linear-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="linear-hypothesis-testing">Linear Hypothesis Testing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod1, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     68.097924   4.823789 14.1171   &lt;2e-16 ***
variable_1      -1.938256   3.353584 -0.5780   0.5635    
I(variable_1^2)  0.573615   0.793874  0.7226   0.4702    
I(variable_1^3) -0.040503   0.053563 -0.7562   0.4498    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                   Estimate  Std. Error t value Pr(&gt;|t|)
(Intercept)      6.2304e+01  4.0853e+01  1.5251   0.1278
variable_2       1.3475e-01  4.7288e-01  0.2850   0.7758
I(variable_2^2) -7.3572e-04  1.7722e-03 -0.4152   0.6782
I(variable_2^3)  9.6901e-07  2.1268e-06  0.4556   0.6488</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod4, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) 75.490554   5.379970 14.0318 &lt; 2.2e-16 ***
variable_1  -0.157023   0.534907 -0.2936  0.769204    
variable_2  -0.044766   0.015478 -2.8921  0.003967 ** 
bpm          0.012119   0.033433  0.3625  0.717123    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod1,</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_1 = 0"</span>, <span class="st">"I(variable_1^2) = 0"</span>, <span class="st">"I(variable_1^3) = 0"</span>),</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
variable_1 = 0
I(variable_1^2) = 0
I(variable_1^3) = 0

Model 1: restricted model
Model 2: pop ~ variable_1 + I(variable_1^2) + I(variable_1^3)

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F Pr(&gt;F)
1    595                 
2    592  3 0.1985 0.8974</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod2,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_2 = 0"</span>, <span class="st">"I(variable_2^2) = 0"</span>, <span class="st">"I(variable_2^3) = 0"</span>),</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
variable_2 = 0
I(variable_2^2) = 0
I(variable_2^3) = 0

Model 1: restricted model
Model 2: pop ~ variable_2 + I(variable_2^2) + I(variable_2^3)

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F Pr(&gt;F)  
1    595                   
2    592  3 3.6335 0.0128 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod4,</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_1 = 0"</span>, <span class="st">"variable_2 = 0"</span>, <span class="st">"bpm = 0"</span>),</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
variable_1 = 0
variable_2 = 0
bpm = 0

Model 1: restricted model
Model 2: pop ~ variable_1 + variable_2 + bpm

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F  Pr(&gt;F)  
1    595                    
2    592  3 2.8018 0.03925 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="written-explanations-what-do-we-see-here" class="level1">
<h1>Written explanations: What do we see here?</h1>
<p>A linear model works well with variables that have a directly linear relationship between one another. It can best represent a simple relationship that falls within a straight line, such as the relationship between hours worked and money earned. The ‘line of best fit’ in the case of Spotify chart data would not be best utilized by a linear relationship, as there is too many factors to consider and too many complex patterns that would be wrongfully ignored in a linear example.</p>
<p>The benefit of non-linear models allows for more flexibility within the growth patterns and the visualizations. These non-linear models in my example, consisting both of polynomial regression and OLS models, provide a more accurate fit to the chart data and to the patterns we are able to see. In the case of model_2, the relationship between duration and popularity, there seems to be a negative relationship as shown by the pink line. From this plot, we are able to see the relationship between duration and popularity, in which the most popular songs (rated on a scale of 0 to 100) have a duration that is under 3 minutes. As the duration increases, the chance of the song charting decreases.</p>
</section>
<section id="citations" class="level1">
<h1>Citations</h1>
<p>Henrique, L. (2019, December 26). Top Spotify songs from 2010-2019 - by Year. Kaggle. https://www.kaggle.com/datasets/leonardopena/top-spotify-songs-from-20102019-by-year</p>
<p>Mermovich, A. (2023, April 28). Spotify Hits (2010-2019) Analytics</p>
<p>Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables. R package version 5.2.3. https://CRAN.R-project.org/package=stargazer</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Summer_Sec_1" data-repo-id="" data-category="Announcements" data-category-id="" data-mapping="url" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb149" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Kruzlic Class Project 2"</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Bryn Kruzlic"</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Second iteration of the class project"</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "08/18/2023"</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - final project 2</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Qasim Abbas</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - dplyr</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a><span class="fu"># These are the libraries being used in the following project. </span></span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dummy)</span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb149-46"><a href="#cb149-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb149-47"><a href="#cb149-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb149-48"><a href="#cb149-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb149-49"><a href="#cb149-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-50"><a href="#cb149-50" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb149-51"><a href="#cb149-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-52"><a href="#cb149-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-53"><a href="#cb149-53" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cleaning up the data</span></span>
<span id="cb149-54"><a href="#cb149-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-55"><a href="#cb149-55" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Unfortunately, this dataset does contain a fair amount of missing data in addition to more measures of music than we need. For this project, we are only focused on genre, dur (duration) and pop (popularity) when it comes to the Top Spotify charting songs from 2010 to 2019. The below code features the cleaning process, merging together different subgenres into one 'umbrella' genre, eliminating repeat values and omitting NAs.</span></span>
<span id="cb149-56"><a href="#cb149-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-59"><a href="#cb149-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-60"><a href="#cb149-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in dataset</span></span>
<span id="cb149-61"><a href="#cb149-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-62"><a href="#cb149-62" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/Bryn Kruzlic/OneDrive/Desktop/MS_DACSS/DACSS603/top10s.csv"</span>)</span>
<span id="cb149-63"><a href="#cb149-63" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(top10s)</span>
<span id="cb149-64"><a href="#cb149-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-65"><a href="#cb149-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-66"><a href="#cb149-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-67"><a href="#cb149-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-70"><a href="#cb149-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-71"><a href="#cb149-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering NAs from the dataset</span></span>
<span id="cb149-72"><a href="#cb149-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-73"><a href="#cb149-73" aria-hidden="true" tabindex="-1"></a>top10s <span class="sc">%&gt;%</span> </span>
<span id="cb149-74"><a href="#cb149-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_all</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb149-75"><a href="#cb149-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bpm <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-76"><a href="#cb149-76" aria-hidden="true" tabindex="-1"></a>           nrgy <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-77"><a href="#cb149-77" aria-hidden="true" tabindex="-1"></a>           dnce <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-78"><a href="#cb149-78" aria-hidden="true" tabindex="-1"></a>           dB <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-79"><a href="#cb149-79" aria-hidden="true" tabindex="-1"></a>           live <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-80"><a href="#cb149-80" aria-hidden="true" tabindex="-1"></a>           dur <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-81"><a href="#cb149-81" aria-hidden="true" tabindex="-1"></a>           spch <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb149-82"><a href="#cb149-82" aria-hidden="true" tabindex="-1"></a>           pop  <span class="sc">==</span> <span class="dv">0</span> )</span>
<span id="cb149-83"><a href="#cb149-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-84"><a href="#cb149-84" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(top10s)</span>
<span id="cb149-85"><a href="#cb149-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-86"><a href="#cb149-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-87"><a href="#cb149-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-88"><a href="#cb149-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-91"><a href="#cb149-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-92"><a href="#cb149-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in the chart due to seperate releases</span></span>
<span id="cb149-93"><a href="#cb149-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-94"><a href="#cb149-94" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb149-95"><a href="#cb149-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">!=</span> <span class="st">'The Hills'</span> <span class="sc">|</span> year <span class="sc">!=</span> <span class="dv">2016</span>)</span>
<span id="cb149-96"><a href="#cb149-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-97"><a href="#cb149-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-98"><a href="#cb149-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-99"><a href="#cb149-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-102"><a href="#cb149-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-103"><a href="#cb149-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging subgenres together for more cohesion</span></span>
<span id="cb149-104"><a href="#cb149-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-105"><a href="#cb149-105" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> top10s[<span class="st">"top genre"</span>]</span>
<span id="cb149-106"><a href="#cb149-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-107"><a href="#cb149-107" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(top10s<span class="sc">$</span><span class="st">'top genre'</span>)</span>
<span id="cb149-108"><a href="#cb149-108" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">separate</span>((<span class="st">`</span><span class="at">top genre</span><span class="st">`</span>),<span class="fu">c</span>(<span class="st">"variable"</span>,<span class="st">"genre"</span>),<span class="at">extra=</span><span class="st">'merge'</span>)</span>
<span id="cb149-109"><a href="#cb149-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-110"><a href="#cb149-110" aria-hidden="true" tabindex="-1"></a>other <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"complextro"</span>, <span class="st">"downtempo"</span>, <span class="st">"brostep"</span>, <span class="st">"electro"</span>, <span class="st">"electronic"</span>, <span class="st">"escape"</span>, <span class="st">"folk-pop"</span>, <span class="st">"hollywood"</span>, <span class="st">"house"</span>, <span class="st">"irish"</span>, <span class="st">"permanent"</span>, <span class="st">"neo"</span>, <span class="st">"metropolis"</span>, <span class="st">"tropical"</span>)</span>
<span id="cb149-111"><a href="#cb149-111" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">%in%</span> other] <span class="ot">&lt;-</span> <span class="st">'other'</span></span>
<span id="cb149-112"><a href="#cb149-112" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'hip'</span>] <span class="ot">&lt;-</span> <span class="st">'hip hop'</span></span>
<span id="cb149-113"><a href="#cb149-113" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'latin'</span>] <span class="ot">&lt;-</span> <span class="st">'latin'</span></span>
<span id="cb149-114"><a href="#cb149-114" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'boy'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb149-115"><a href="#cb149-115" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'french'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb149-116"><a href="#cb149-116" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'electropop'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb149-117"><a href="#cb149-117" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">'pop'</span>] <span class="ot">&lt;-</span> <span class="st">'pop'</span></span>
<span id="cb149-118"><a href="#cb149-118" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>genre <span class="sc">==</span> <span class="st">'contemporary r&amp;b'</span>] <span class="ot">&lt;-</span> <span class="st">'r&amp;b'</span></span>
<span id="cb149-119"><a href="#cb149-119" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre[top10s<span class="sc">$</span>genre <span class="sc">==</span> <span class="st">'room'</span>] <span class="ot">&lt;-</span> <span class="st">'other'</span></span>
<span id="cb149-120"><a href="#cb149-120" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(top10s<span class="sc">$</span>genre)</span>
<span id="cb149-121"><a href="#cb149-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-122"><a href="#cb149-122" aria-hidden="true" tabindex="-1"></a>miss <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(top10s))</span>
<span id="cb149-123"><a href="#cb149-123" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(miss[miss<span class="sc">&gt;</span><span class="dv">0</span>])</span>
<span id="cb149-124"><a href="#cb149-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-125"><a href="#cb149-125" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span><span class="fu">na.omit</span>(top10s)</span>
<span id="cb149-126"><a href="#cb149-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-127"><a href="#cb149-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-128"><a href="#cb149-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-129"><a href="#cb149-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-130"><a href="#cb149-130" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grouping and Analysis- Defining and Representing Variables</span></span>
<span id="cb149-131"><a href="#cb149-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-132"><a href="#cb149-132" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Top Artists*</span></span>
<span id="cb149-133"><a href="#cb149-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-134"><a href="#cb149-134" aria-hidden="true" tabindex="-1"></a><span class="fu">##### This below chart represents the artists with the highest number of charting songs between 2010 and 2019. </span></span>
<span id="cb149-135"><a href="#cb149-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-138"><a href="#cb149-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-139"><a href="#cb149-139" aria-hidden="true" tabindex="-1"></a>pop_artist <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))<span class="sc">%&gt;%</span><span class="fu">group_by</span>(artist)</span>
<span id="cb149-140"><a href="#cb149-140" aria-hidden="true" tabindex="-1"></a>pop_artist</span>
<span id="cb149-141"><a href="#cb149-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-142"><a href="#cb149-142" aria-hidden="true" tabindex="-1"></a>top_artist<span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span></span>
<span id="cb149-143"><a href="#cb149-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb149-144"><a href="#cb149-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(artist)<span class="sc">%&gt;%</span></span>
<span id="cb149-145"><a href="#cb149-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop=</span>n<span class="sc">/</span><span class="fu">sum</span>(n))</span>
<span id="cb149-146"><a href="#cb149-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-147"><a href="#cb149-147" aria-hidden="true" tabindex="-1"></a>most_popular_artist <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb149-148"><a href="#cb149-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(artist) <span class="sc">%&gt;%</span> </span>
<span id="cb149-149"><a href="#cb149-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no.of.songs =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb149-150"><a href="#cb149-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(no.of.songs)) </span>
<span id="cb149-151"><a href="#cb149-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-152"><a href="#cb149-152" aria-hidden="true" tabindex="-1"></a>summarized_songs_artist <span class="ot">&lt;-</span> most_popular_artist <span class="sc">%&gt;%</span> </span>
<span id="cb149-153"><a href="#cb149-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(no.of.songs,<span class="at">n=</span><span class="dv">15</span>)</span>
<span id="cb149-154"><a href="#cb149-154" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(summarized_songs_artist)</span>
<span id="cb149-155"><a href="#cb149-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-156"><a href="#cb149-156" aria-hidden="true" tabindex="-1"></a>most_popular_artist <span class="ot">&lt;-</span> pop_artist<span class="sc">%&gt;%</span><span class="fu">count</span>(artist)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb149-157"><a href="#cb149-157" aria-hidden="true" tabindex="-1"></a>most_popular_artist<span class="sc">%&gt;%</span><span class="fu">head</span>(<span class="dv">15</span>)<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(artist,n),<span class="at">y=</span>n))<span class="sc">+</span><span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"15 Most Popular Artists"</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()</span>
<span id="cb149-158"><a href="#cb149-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-159"><a href="#cb149-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-160"><a href="#cb149-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-161"><a href="#cb149-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Song Duration*</span></span>
<span id="cb149-162"><a href="#cb149-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-163"><a href="#cb149-163" aria-hidden="true" tabindex="-1"></a><span class="fu">##### This below chart represents the average duration of songs by genre. Not surprisingly, the majority of top charting Spotify songs are in Pop, with most of the songs averaging between 200 and 300 seconds. This means that the majority of charting Pop songs range from 3.5 to 5 minutes. </span></span>
<span id="cb149-164"><a href="#cb149-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-167"><a href="#cb149-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-168"><a href="#cb149-168" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(genre,dur),<span class="at">y=</span>dur))<span class="sc">+</span><span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"limegreen"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Song Duration"</span>)<span class="sc">+</span><span class="fu">theme_light</span>()</span>
<span id="cb149-169"><a href="#cb149-169" aria-hidden="true" tabindex="-1"></a>duration</span>
<span id="cb149-170"><a href="#cb149-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-171"><a href="#cb149-171" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb149-172"><a href="#cb149-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, dur), <span class="at">y =</span> dur)) <span class="sc">+</span></span>
<span id="cb149-173"><a href="#cb149-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-174"><a href="#cb149-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Song Duration"</span>) <span class="sc">+</span></span>
<span id="cb149-175"><a href="#cb149-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Genre"</span>) <span class="sc">+</span></span>
<span id="cb149-176"><a href="#cb149-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Duration"</span>) <span class="sc">+</span></span>
<span id="cb149-177"><a href="#cb149-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb149-178"><a href="#cb149-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>)) <span class="sc">+</span></span>
<span id="cb149-179"><a href="#cb149-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb149-180"><a href="#cb149-180" aria-hidden="true" tabindex="-1"></a>duration</span>
<span id="cb149-181"><a href="#cb149-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-182"><a href="#cb149-182" aria-hidden="true" tabindex="-1"></a>summarized_data_genre <span class="ot">&lt;-</span> top10s <span class="sc">%&gt;%</span> </span>
<span id="cb149-183"><a href="#cb149-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">%&gt;%</span> </span>
<span id="cb149-184"><a href="#cb149-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_duration =</span> <span class="fu">mean</span>(dur)) <span class="sc">%&gt;%</span> </span>
<span id="cb149-185"><a href="#cb149-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_duration))</span>
<span id="cb149-186"><a href="#cb149-186" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(summarized_data_genre)</span>
<span id="cb149-187"><a href="#cb149-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-188"><a href="#cb149-188" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(summarized_data_genre) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Song Genre"</span>, <span class="st">"Average Song Duration"</span>)</span>
<span id="cb149-189"><a href="#cb149-189" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(dur_genre)</span>
<span id="cb149-190"><a href="#cb149-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-191"><a href="#cb149-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-192"><a href="#cb149-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-193"><a href="#cb149-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Most and Least Popular Songs*</span></span>
<span id="cb149-194"><a href="#cb149-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-197"><a href="#cb149-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-198"><a href="#cb149-198" aria-hidden="true" tabindex="-1"></a>max_pop <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">filter</span>(pop<span class="sc">&gt;=</span><span class="dv">60</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(artist,pop,title,genre)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))</span>
<span id="cb149-199"><a href="#cb149-199" aria-hidden="true" tabindex="-1"></a>max_pop</span>
<span id="cb149-200"><a href="#cb149-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-201"><a href="#cb149-201" aria-hidden="true" tabindex="-1"></a>min_pop <span class="ot">&lt;-</span>top10s<span class="sc">%&gt;%</span><span class="fu">filter</span>(pop<span class="sc">&lt;=</span><span class="dv">59</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(artist,pop,title,genre)<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pop))</span>
<span id="cb149-202"><a href="#cb149-202" aria-hidden="true" tabindex="-1"></a>min_pop</span>
<span id="cb149-203"><a href="#cb149-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-204"><a href="#cb149-204" aria-hidden="true" tabindex="-1"></a>max_pop_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(top10s<span class="sc">$</span>pop, <span class="fl">0.9</span>)</span>
<span id="cb149-205"><a href="#cb149-205" aria-hidden="true" tabindex="-1"></a>min_pop_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(top10s<span class="sc">$</span>pop, <span class="fl">0.1</span>)</span>
<span id="cb149-206"><a href="#cb149-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-207"><a href="#cb149-207" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop, <span class="at">color =</span> <span class="fu">ifelse</span>(pop <span class="sc">&gt;=</span> max_pop_threshold, <span class="st">"Max Popularity"</span>, <span class="fu">ifelse</span>(pop <span class="sc">&lt;=</span> min_pop_threshold, <span class="st">"Min Popularity"</span>, <span class="st">"Intermediate"</span>)))) <span class="sc">+</span></span>
<span id="cb149-208"><a href="#cb149-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-209"><a href="#cb149-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Song Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>, <span class="at">color =</span> <span class="st">"Popularity Level by Genre"</span>) <span class="sc">+</span></span>
<span id="cb149-210"><a href="#cb149-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Max Popularity"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Min Popularity"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Intermediate"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb149-211"><a href="#cb149-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-212"><a href="#cb149-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb149-213"><a href="#cb149-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-214"><a href="#cb149-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-215"><a href="#cb149-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-216"><a href="#cb149-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-217"><a href="#cb149-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-218"><a href="#cb149-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-219"><a href="#cb149-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Plot PDF and CDF*</span></span>
<span id="cb149-220"><a href="#cb149-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-223"><a href="#cb149-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-224"><a href="#cb149-224" aria-hidden="true" tabindex="-1"></a>var1_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span>
<span id="cb149-225"><a href="#cb149-225" aria-hidden="true" tabindex="-1"></a>var1_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(var1_pdf)</span>
<span id="cb149-226"><a href="#cb149-226" aria-hidden="true" tabindex="-1"></a>var1_pdf_cdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Genre =</span> <span class="fu">names</span>(var1_pdf), <span class="at">Probability =</span> var1_pdf, <span class="at">Cumulative =</span> var1_cdf)</span>
<span id="cb149-227"><a href="#cb149-227" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var1_pdf_cdf)</span>
<span id="cb149-228"><a href="#cb149-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-229"><a href="#cb149-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-230"><a href="#cb149-230" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">density</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb149-231"><a href="#cb149-231" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>dur))</span>
<span id="cb149-232"><a href="#cb149-232" aria-hidden="true" tabindex="-1"></a>var2_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb149-233"><a href="#cb149-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-234"><a href="#cb149-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-235"><a href="#cb149-235" aria-hidden="true" tabindex="-1"></a>var2_pdf <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>dur))</span>
<span id="cb149-236"><a href="#cb149-236" aria-hidden="true" tabindex="-1"></a>var2_cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(var2_pdf)</span>
<span id="cb149-237"><a href="#cb149-237" aria-hidden="true" tabindex="-1"></a>var2_pdf_cdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Duration =</span> <span class="fu">unique</span>(top10s<span class="sc">$</span>dur),</span>
<span id="cb149-238"><a href="#cb149-238" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Probability =</span> var2_pdf,</span>
<span id="cb149-239"><a href="#cb149-239" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cumulative =</span> var2_cdf)</span>
<span id="cb149-240"><a href="#cb149-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-241"><a href="#cb149-241" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(var2_pdf_cdf)</span>
<span id="cb149-242"><a href="#cb149-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-243"><a href="#cb149-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-244"><a href="#cb149-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-245"><a href="#cb149-245" aria-hidden="true" tabindex="-1"></a><span class="fu">##### PDF or probability density function and CDF or cumulative distribution function can help us understand the likelihood of a random variable taking on a particular value. In the example of Spotify chart data, the PDF can provide insight on how frequent these values may appear and the CDF can help us understand how these specific features can impact a songs' relative popularity and performance. </span></span>
<span id="cb149-246"><a href="#cb149-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-247"><a href="#cb149-247" aria-hidden="true" tabindex="-1"></a><span class="fu"># Variable Defining and Redefining</span></span>
<span id="cb149-248"><a href="#cb149-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-251"><a href="#cb149-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-252"><a href="#cb149-252" aria-hidden="true" tabindex="-1"></a><span class="co"># naming the variables</span></span>
<span id="cb149-253"><a href="#cb149-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-254"><a href="#cb149-254" aria-hidden="true" tabindex="-1"></a>genre_mapping <span class="ot">&lt;-</span> <span class="fu">unique</span>(top10s<span class="sc">$</span>genre)</span>
<span id="cb149-255"><a href="#cb149-255" aria-hidden="true" tabindex="-1"></a>variable_1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(top10s<span class="sc">$</span>genre, <span class="at">levels =</span> genre_mapping))</span>
<span id="cb149-256"><a href="#cb149-256" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(variable_1) <span class="co"># genre of the popular songs</span></span>
<span id="cb149-257"><a href="#cb149-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-258"><a href="#cb149-258" aria-hidden="true" tabindex="-1"></a>variable_2 <span class="ot">&lt;-</span> top10s<span class="sc">$</span>dur <span class="co"># duration of the popular songs </span></span>
<span id="cb149-259"><a href="#cb149-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-260"><a href="#cb149-260" aria-hidden="true" tabindex="-1"></a>variable_3 <span class="ot">&lt;-</span> top10s<span class="sc">$</span>pop <span class="co"># popularity score of songs; used for omitted variable bias</span></span>
<span id="cb149-261"><a href="#cb149-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-262"><a href="#cb149-262" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>variable_1 <span class="ot">&lt;-</span> variable_1</span>
<span id="cb149-263"><a href="#cb149-263" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>variable_2 <span class="ot">&lt;-</span> variable_2</span>
<span id="cb149-264"><a href="#cb149-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-265"><a href="#cb149-265" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and standard deviations</span></span>
<span id="cb149-266"><a href="#cb149-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-267"><a href="#cb149-267" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_1)</span>
<span id="cb149-268"><a href="#cb149-268" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_1)</span>
<span id="cb149-269"><a href="#cb149-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-270"><a href="#cb149-270" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_2)</span>
<span id="cb149-271"><a href="#cb149-271" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_2)</span>
<span id="cb149-272"><a href="#cb149-272" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-273"><a href="#cb149-273" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(variable_3)</span>
<span id="cb149-274"><a href="#cb149-274" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(variable_3)</span>
<span id="cb149-275"><a href="#cb149-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-276"><a href="#cb149-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-277"><a href="#cb149-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-278"><a href="#cb149-278" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Standard Errors*</span></span>
<span id="cb149-279"><a href="#cb149-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-282"><a href="#cb149-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-283"><a href="#cb149-283" aria-hidden="true" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x)))</span>
<span id="cb149-284"><a href="#cb149-284" aria-hidden="true" tabindex="-1"></a>sufficient_observations <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">length</span>(x) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb149-285"><a href="#cb149-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-286"><a href="#cb149-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-287"><a href="#cb149-287" aria-hidden="true" tabindex="-1"></a>genre_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span>
<span id="cb149-288"><a href="#cb149-288" aria-hidden="true" tabindex="-1"></a>genre_sample_sizes <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre))</span>
<span id="cb149-289"><a href="#cb149-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-290"><a href="#cb149-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-291"><a href="#cb149-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-292"><a href="#cb149-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-293"><a href="#cb149-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Generating Plots*</span></span>
<span id="cb149-294"><a href="#cb149-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-297"><a href="#cb149-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-298"><a href="#cb149-298" aria-hidden="true" tabindex="-1"></a>average_duration <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">FUN =</span> mean)</span>
<span id="cb149-299"><a href="#cb149-299" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(average_duration<span class="sc">$</span>dur, <span class="at">names.arg =</span> average_duration<span class="sc">$</span>genre, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Duration"</span>, <span class="at">main =</span> <span class="st">"Average Duration by Genre"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb149-300"><a href="#cb149-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-301"><a href="#cb149-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-302"><a href="#cb149-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-303"><a href="#cb149-303" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regression Analysis</span></span>
<span id="cb149-304"><a href="#cb149-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-307"><a href="#cb149-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-308"><a href="#cb149-308" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>dur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb149-309"><a href="#cb149-309" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">is.na</span>(top10s<span class="sc">$</span>dur)</span>
<span id="cb149-310"><a href="#cb149-310" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> top10s[<span class="sc">!</span>missing_values, ]</span>
<span id="cb149-311"><a href="#cb149-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-312"><a href="#cb149-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-313"><a href="#cb149-313" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(top10s<span class="sc">$</span>genre, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">main =</span> <span class="st">"Top 10s - Genre Distribution"</span>)</span>
<span id="cb149-314"><a href="#cb149-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-315"><a href="#cb149-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-316"><a href="#cb149-316" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dur <span class="sc">~</span> genre, <span class="at">data =</span> top10s, <span class="at">col =</span> <span class="st">"maroon"</span>, <span class="at">xlab =</span> <span class="st">"Genre"</span>, <span class="at">ylab =</span> <span class="st">"Duration"</span>, <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">median</span>(top10s<span class="sc">$</span>dur), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>), <span class="at">main =</span> <span class="st">"Top 10s - Duration by Genre"</span>)</span>
<span id="cb149-317"><a href="#cb149-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-318"><a href="#cb149-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-319"><a href="#cb149-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-320"><a href="#cb149-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-321"><a href="#cb149-321" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correlations</span></span>
<span id="cb149-322"><a href="#cb149-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-323"><a href="#cb149-323" aria-hidden="true" tabindex="-1"></a><span class="fu">##### The graphs below will allow us to see the correlation between specific variables within the dataset. For the purpose of our research, only the variables "genre", "dur" and "bpm" will be utilized. </span></span>
<span id="cb149-324"><a href="#cb149-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-327"><a href="#cb149-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-328"><a href="#cb149-328" aria-hidden="true" tabindex="-1"></a>bpm_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>bpm,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"BPM/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb149-329"><a href="#cb149-329" aria-hidden="true" tabindex="-1"></a>bpm_pop</span>
<span id="cb149-330"><a href="#cb149-330" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>bpm, top10s<span class="sc">$</span>pop)</span>
<span id="cb149-331"><a href="#cb149-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-332"><a href="#cb149-332" aria-hidden="true" tabindex="-1"></a>dur_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>dur,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Duration/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb149-333"><a href="#cb149-333" aria-hidden="true" tabindex="-1"></a>dur_pop</span>
<span id="cb149-334"><a href="#cb149-334" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>dur, top10s<span class="sc">$</span>pop)</span>
<span id="cb149-335"><a href="#cb149-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-336"><a href="#cb149-336" aria-hidden="true" tabindex="-1"></a>genre_pop <span class="ot">&lt;-</span> top10s<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable_1,<span class="at">y=</span>pop))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Genre/Popularity"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb149-337"><a href="#cb149-337" aria-hidden="true" tabindex="-1"></a>genre_pop</span>
<span id="cb149-338"><a href="#cb149-338" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(top10s<span class="sc">$</span>variable_1, top10s<span class="sc">$</span>pop)</span>
<span id="cb149-339"><a href="#cb149-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-340"><a href="#cb149-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-341"><a href="#cb149-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-342"><a href="#cb149-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-343"><a href="#cb149-343" aria-hidden="true" tabindex="-1"></a><span class="fu"># Customize Variable Models</span></span>
<span id="cb149-344"><a href="#cb149-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-347"><a href="#cb149-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-348"><a href="#cb149-348" aria-hidden="true" tabindex="-1"></a>model_genre <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> genre, <span class="at">data =</span> top10s)</span>
<span id="cb149-349"><a href="#cb149-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-350"><a href="#cb149-350" aria-hidden="true" tabindex="-1"></a>model_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> dur, <span class="at">data =</span> top10s)</span>
<span id="cb149-351"><a href="#cb149-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-352"><a href="#cb149-352" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2, <span class="at">data =</span> top10s) <span class="co">#multiple regression model</span></span>
<span id="cb149-353"><a href="#cb149-353" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)<span class="sc">$</span>coef</span>
<span id="cb149-354"><a href="#cb149-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-355"><a href="#cb149-355" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> <span class="fu">log</span>(variable_1) <span class="sc">+</span> <span class="fu">log</span>(variable_2), <span class="at">data =</span> top10s) <span class="co"># log-linear model</span></span>
<span id="cb149-356"><a href="#cb149-356" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)<span class="sc">$</span>coef</span>
<span id="cb149-357"><a href="#cb149-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-358"><a href="#cb149-358" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> <span class="fu">I</span>(variable_1) <span class="sc">+</span> <span class="fu">I</span>(variable_2) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s) <span class="co"># high order polynomial </span></span>
<span id="cb149-359"><a href="#cb149-359" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3)<span class="sc">$</span>coef</span>
<span id="cb149-360"><a href="#cb149-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-361"><a href="#cb149-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-362"><a href="#cb149-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-363"><a href="#cb149-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-364"><a href="#cb149-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-365"><a href="#cb149-365" aria-hidden="true" tabindex="-1"></a><span class="fu"># Plot Observations</span></span>
<span id="cb149-366"><a href="#cb149-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-367"><a href="#cb149-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-370"><a href="#cb149-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-371"><a href="#cb149-371" aria-hidden="true" tabindex="-1"></a><span class="co">#Attempting again to omit NA values</span></span>
<span id="cb149-372"><a href="#cb149-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-373"><a href="#cb149-373" aria-hidden="true" tabindex="-1"></a>top10s <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(top10s)</span>
<span id="cb149-374"><a href="#cb149-374" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(top10s<span class="sc">$</span>genre)</span>
<span id="cb149-375"><a href="#cb149-375" aria-hidden="true" tabindex="-1"></a>variable_1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(variable_1)</span>
<span id="cb149-376"><a href="#cb149-376" aria-hidden="true" tabindex="-1"></a>variable_2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(variable_2)</span>
<span id="cb149-377"><a href="#cb149-377" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_1)</span>
<span id="cb149-378"><a href="#cb149-378" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_2)</span>
<span id="cb149-379"><a href="#cb149-379" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(model_3)</span>
<span id="cb149-380"><a href="#cb149-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-381"><a href="#cb149-381" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(variable_1, variable_2)</span>
<span id="cb149-382"><a href="#cb149-382" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_for_plot)</span>
<span id="cb149-383"><a href="#cb149-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-384"><a href="#cb149-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-385"><a href="#cb149-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-386"><a href="#cb149-386" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Model 1:* </span></span>
<span id="cb149-387"><a href="#cb149-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-390"><a href="#cb149-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-391"><a href="#cb149-391" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the following observations- Multiple Regression Model</span></span>
<span id="cb149-392"><a href="#cb149-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-393"><a href="#cb149-393" aria-hidden="true" tabindex="-1"></a>intercept_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"(Intercept)"</span>]</span>
<span id="cb149-394"><a href="#cb149-394" aria-hidden="true" tabindex="-1"></a>coef_variable_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"variable_1"</span>]</span>
<span id="cb149-395"><a href="#cb149-395" aria-hidden="true" tabindex="-1"></a>coef_variable_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_1)[<span class="st">"variable_2"</span>]</span>
<span id="cb149-396"><a href="#cb149-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-397"><a href="#cb149-397" aria-hidden="true" tabindex="-1"></a>predicted_pop_1 <span class="ot">&lt;-</span> intercept_1 <span class="sc">+</span> coef_variable_1 <span class="sc">*</span> top10s<span class="sc">$</span>variable_1 <span class="sc">+</span></span>
<span id="cb149-398"><a href="#cb149-398" aria-hidden="true" tabindex="-1"></a>                 coef_variable_2 <span class="sc">*</span> top10s<span class="sc">$</span>variable_2</span>
<span id="cb149-399"><a href="#cb149-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-400"><a href="#cb149-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-401"><a href="#cb149-401" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-402"><a href="#cb149-402" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> predicted_pop_1), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb149-403"><a href="#cb149-403" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb149-404"><a href="#cb149-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-405"><a href="#cb149-405" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb149-406"><a href="#cb149-406" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span>
<span id="cb149-407"><a href="#cb149-407" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-408"><a href="#cb149-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-409"><a href="#cb149-409" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-410"><a href="#cb149-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-411"><a href="#cb149-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> predicted_pop_1), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb149-412"><a href="#cb149-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb149-413"><a href="#cb149-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-414"><a href="#cb149-414" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb149-415"><a href="#cb149-415" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-416"><a href="#cb149-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-417"><a href="#cb149-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-418"><a href="#cb149-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-419"><a href="#cb149-419" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Model 2:*</span></span>
<span id="cb149-420"><a href="#cb149-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-423"><a href="#cb149-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-424"><a href="#cb149-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the following observations- OLS Equation</span></span>
<span id="cb149-425"><a href="#cb149-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-426"><a href="#cb149-426" aria-hidden="true" tabindex="-1"></a>intercept_ols <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"(Intercept)"</span>]</span>
<span id="cb149-427"><a href="#cb149-427" aria-hidden="true" tabindex="-1"></a>coef_variable_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"variable_1"</span>]</span>
<span id="cb149-428"><a href="#cb149-428" aria-hidden="true" tabindex="-1"></a>coef_variable_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_2)[<span class="st">"variable_2"</span>]</span>
<span id="cb149-429"><a href="#cb149-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-430"><a href="#cb149-430" aria-hidden="true" tabindex="-1"></a>predicted_pop_ols <span class="ot">&lt;-</span> intercept_ols <span class="sc">+</span> coef_variable_1 <span class="sc">*</span> top10s<span class="sc">$</span>variable_1 <span class="sc">+</span> coef_variable_2 <span class="sc">*</span> top10s<span class="sc">$</span>variable_2</span>
<span id="cb149-431"><a href="#cb149-431" aria-hidden="true" tabindex="-1"></a>na.rm <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb149-432"><a href="#cb149-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-433"><a href="#cb149-433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-434"><a href="#cb149-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb149-435"><a href="#cb149-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> <span class="fu">fitted</span>(model_2)), <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb149-436"><a href="#cb149-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-437"><a href="#cb149-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-438"><a href="#cb149-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-439"><a href="#cb149-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-440"><a href="#cb149-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-441"><a href="#cb149-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-442"><a href="#cb149-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb149-443"><a href="#cb149-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> <span class="fu">fitted</span>(model_2)), <span class="at">col =</span> <span class="st">"pink"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb149-444"><a href="#cb149-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-445"><a href="#cb149-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-446"><a href="#cb149-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-447"><a href="#cb149-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-448"><a href="#cb149-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-449"><a href="#cb149-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-450"><a href="#cb149-450" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Model 3:*</span></span>
<span id="cb149-451"><a href="#cb149-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-454"><a href="#cb149-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-455"><a href="#cb149-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the following observations- High Order Polynomial</span></span>
<span id="cb149-456"><a href="#cb149-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-457"><a href="#cb149-457" aria-hidden="true" tabindex="-1"></a>top10s<span class="sc">$</span>predicted_pop <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_3, <span class="at">newdata =</span> top10s)</span>
<span id="cb149-458"><a href="#cb149-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-459"><a href="#cb149-459" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-460"><a href="#cb149-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-461"><a href="#cb149-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_1, <span class="at">y =</span> predicted_pop), <span class="at">color =</span> <span class="st">"maroon"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb149-462"><a href="#cb149-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-463"><a href="#cb149-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-464"><a href="#cb149-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-465"><a href="#cb149-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-466"><a href="#cb149-466" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10s, <span class="fu">aes</span>(<span class="at">x =</span> dur, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb149-467"><a href="#cb149-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-468"><a href="#cb149-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable_2, <span class="at">y =</span> predicted_pop), <span class="at">color =</span> <span class="st">"maroon"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb149-469"><a href="#cb149-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Duration"</span>, <span class="at">y =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb149-470"><a href="#cb149-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-471"><a href="#cb149-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb149-472"><a href="#cb149-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-473"><a href="#cb149-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-474"><a href="#cb149-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-475"><a href="#cb149-475" aria-hidden="true" tabindex="-1"></a><span class="fu"># Finding the Best Model Specifications</span></span>
<span id="cb149-476"><a href="#cb149-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-479"><a href="#cb149-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-480"><a href="#cb149-480" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating multiple specifications to find best model</span></span>
<span id="cb149-481"><a href="#cb149-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-482"><a href="#cb149-482" aria-hidden="true" tabindex="-1"></a>top10s_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_1<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s)</span>
<span id="cb149-483"><a href="#cb149-483" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-484"><a href="#cb149-484" aria-hidden="true" tabindex="-1"></a>top10s_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_2 <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(variable_2<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> top10s)</span>
<span id="cb149-485"><a href="#cb149-485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-486"><a href="#cb149-486" aria-hidden="true" tabindex="-1"></a>top10s_mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2 <span class="sc">+</span> variable_3, <span class="at">data =</span> top10s) <span class="co"># exclude from future manipulations</span></span>
<span id="cb149-487"><a href="#cb149-487" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-488"><a href="#cb149-488" aria-hidden="true" tabindex="-1"></a>top10s_mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop <span class="sc">~</span> variable_1 <span class="sc">+</span> variable_2 <span class="sc">+</span> bpm, <span class="at">data =</span> top10s)</span>
<span id="cb149-489"><a href="#cb149-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-490"><a href="#cb149-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-491"><a href="#cb149-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-492"><a href="#cb149-492" aria-hidden="true" tabindex="-1"></a><span class="fu">### *Checking for multicollinearity in the following models:*</span></span>
<span id="cb149-493"><a href="#cb149-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-496"><a href="#cb149-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-497"><a href="#cb149-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempting to mitigate multicollinearity in the previous models</span></span>
<span id="cb149-498"><a href="#cb149-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-499"><a href="#cb149-499" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(top10s[, <span class="fu">c</span>(<span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>)])</span>
<span id="cb149-500"><a href="#cb149-500" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span>
<span id="cb149-501"><a href="#cb149-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-502"><a href="#cb149-502" aria-hidden="true" tabindex="-1"></a><span class="do">### correlation value of -0.03618429 suggests that the variables are not strongly correlated.</span></span>
<span id="cb149-503"><a href="#cb149-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-504"><a href="#cb149-504" aria-hidden="true" tabindex="-1"></a>vif_results_1 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_1)</span>
<span id="cb149-505"><a href="#cb149-505" aria-hidden="true" tabindex="-1"></a>vif_results_2 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_2)</span>
<span id="cb149-506"><a href="#cb149-506" aria-hidden="true" tabindex="-1"></a>vif_results_3 <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_3)</span>
<span id="cb149-507"><a href="#cb149-507" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_1)</span>
<span id="cb149-508"><a href="#cb149-508" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_2)</span>
<span id="cb149-509"><a href="#cb149-509" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_results_3)</span>
<span id="cb149-510"><a href="#cb149-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-511"><a href="#cb149-511" aria-hidden="true" tabindex="-1"></a><span class="do">### very high variance inflation factor (VIF) for model_3, the higher order polynomial equation, signifying multicollinearity in the model. </span></span>
<span id="cb149-512"><a href="#cb149-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-513"><a href="#cb149-513" aria-hidden="true" tabindex="-1"></a>tolerance_values_1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_1</span>
<span id="cb149-514"><a href="#cb149-514" aria-hidden="true" tabindex="-1"></a>tolerance_values_2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_2</span>
<span id="cb149-515"><a href="#cb149-515" aria-hidden="true" tabindex="-1"></a>tolerance_values_3 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> vif_results_3</span>
<span id="cb149-516"><a href="#cb149-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-517"><a href="#cb149-517" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_1)</span>
<span id="cb149-518"><a href="#cb149-518" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_2)</span>
<span id="cb149-519"><a href="#cb149-519" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tolerance_values_3)</span>
<span id="cb149-520"><a href="#cb149-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-521"><a href="#cb149-521" aria-hidden="true" tabindex="-1"></a><span class="do">### very low (close to 0) score for model_3, signifying multicollinearity in the model. </span></span>
<span id="cb149-522"><a href="#cb149-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-523"><a href="#cb149-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempting to mitigate multicollinearity in the newest models</span></span>
<span id="cb149-524"><a href="#cb149-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-525"><a href="#cb149-525" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(top10s[, <span class="fu">c</span>(<span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>, <span class="st">"pop"</span>, <span class="st">"bpm"</span>)])</span>
<span id="cb149-526"><a href="#cb149-526" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlation_matrix)</span>
<span id="cb149-527"><a href="#cb149-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-528"><a href="#cb149-528" aria-hidden="true" tabindex="-1"></a><span class="do">### correlation value less than 1 suggest that the variables are not strongly correlated.</span></span>
<span id="cb149-529"><a href="#cb149-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-530"><a href="#cb149-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-531"><a href="#cb149-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-532"><a href="#cb149-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-533"><a href="#cb149-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Obtaining Robust Standard Errors and Stargazer</span></span>
<span id="cb149-534"><a href="#cb149-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-537"><a href="#cb149-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-538"><a href="#cb149-538" aria-hidden="true" tabindex="-1"></a>se_1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb149-539"><a href="#cb149-539" aria-hidden="true" tabindex="-1"></a>se_2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb149-540"><a href="#cb149-540" aria-hidden="true" tabindex="-1"></a>se_3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod3, <span class="at">type =</span> <span class="st">"HC1"</span>))) <span class="co"># 'Y' value of 'pop' within the dataset 'top10s' equates to the third variable and therefore, cannot be used. </span></span>
<span id="cb149-541"><a href="#cb149-541" aria-hidden="true" tabindex="-1"></a>se_4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>)))</span>
<span id="cb149-542"><a href="#cb149-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-543"><a href="#cb149-543" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb149-544"><a href="#cb149-544" aria-hidden="true" tabindex="-1"></a> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb149-545"><a href="#cb149-545" aria-hidden="true" tabindex="-1"></a> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb149-546"><a href="#cb149-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-547"><a href="#cb149-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-548"><a href="#cb149-548" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(top10s_mod1, top10s_mod2, top10s_mod4,</span>
<span id="cb149-549"><a href="#cb149-549" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Regression Models"</span>,</span>
<span id="cb149-550"><a href="#cb149-550" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb149-551"><a href="#cb149-551" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb149-552"><a href="#cb149-552" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb149-553"><a href="#cb149-553" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb149-554"><a href="#cb149-554" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"(i)"</span>, <span class="st">"(ii)"</span>, <span class="st">"(iiii)"</span>)) </span>
<span id="cb149-555"><a href="#cb149-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-556"><a href="#cb149-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-557"><a href="#cb149-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-558"><a href="#cb149-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-559"><a href="#cb149-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Hypothesis Testing</span></span>
<span id="cb149-560"><a href="#cb149-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-563"><a href="#cb149-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb149-564"><a href="#cb149-564" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod1, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span>
<span id="cb149-565"><a href="#cb149-565" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span>
<span id="cb149-566"><a href="#cb149-566" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(top10s_mod4, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span>
<span id="cb149-567"><a href="#cb149-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-568"><a href="#cb149-568" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod1,</span>
<span id="cb149-569"><a href="#cb149-569" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_1 = 0"</span>, <span class="st">"I(variable_1^2) = 0"</span>, <span class="st">"I(variable_1^3) = 0"</span>),</span>
<span id="cb149-570"><a href="#cb149-570" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod1, <span class="at">type =</span> <span class="st">"HC1"</span>))</span>
<span id="cb149-571"><a href="#cb149-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-572"><a href="#cb149-572" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod2,</span>
<span id="cb149-573"><a href="#cb149-573" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_2 = 0"</span>, <span class="st">"I(variable_2^2) = 0"</span>, <span class="st">"I(variable_2^3) = 0"</span>),</span>
<span id="cb149-574"><a href="#cb149-574" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod2, <span class="at">type =</span> <span class="st">"HC1"</span>))</span>
<span id="cb149-575"><a href="#cb149-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-576"><a href="#cb149-576" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(top10s_mod4,</span>
<span id="cb149-577"><a href="#cb149-577" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="st">"variable_1 = 0"</span>, <span class="st">"variable_2 = 0"</span>, <span class="st">"bpm = 0"</span>),</span>
<span id="cb149-578"><a href="#cb149-578" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(top10s_mod4, <span class="at">type =</span> <span class="st">"HC1"</span>))</span>
<span id="cb149-579"><a href="#cb149-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-580"><a href="#cb149-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-581"><a href="#cb149-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb149-582"><a href="#cb149-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-583"><a href="#cb149-583" aria-hidden="true" tabindex="-1"></a><span class="fu"># Written explanations: What do we see here? </span></span>
<span id="cb149-584"><a href="#cb149-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-585"><a href="#cb149-585" aria-hidden="true" tabindex="-1"></a>A linear model works well with variables that have a directly linear relationship between one another. It can best represent a simple relationship that falls within a straight line, such as the relationship between hours worked and money earned. The 'line of best fit' in the case of Spotify chart data would not be best utilized by a linear relationship, as there is too many factors to consider and too many complex patterns that would be wrongfully ignored in a linear example.</span>
<span id="cb149-586"><a href="#cb149-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-587"><a href="#cb149-587" aria-hidden="true" tabindex="-1"></a>The benefit of non-linear models allows for more flexibility within the growth patterns and the visualizations. These non-linear models in my example, consisting both of polynomial regression and OLS models, provide a more accurate fit to the chart data and to the patterns we are able to see. In the case of model_2, the relationship between duration and popularity, there seems to be a negative relationship as shown by the pink line. From this plot, we are able to see the relationship between duration and popularity, in which the most popular songs (rated on a scale of 0 to 100) have a duration that is under 3 minutes. As the duration increases, the chance of the song charting decreases. </span>
<span id="cb149-588"><a href="#cb149-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-589"><a href="#cb149-589" aria-hidden="true" tabindex="-1"></a><span class="fu"># Citations</span></span>
<span id="cb149-590"><a href="#cb149-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-591"><a href="#cb149-591" aria-hidden="true" tabindex="-1"></a>Henrique, L. (2019, December 26). Top Spotify songs from 2010-2019 - by Year. Kaggle. https://www.kaggle.com/datasets/leonardopena/top-spotify-songs-from-20102019-by-year </span>
<span id="cb149-592"><a href="#cb149-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-593"><a href="#cb149-593" aria-hidden="true" tabindex="-1"></a>Mermovich, A. (2023, April 28). Spotify Hits (2010-2019) Analytics</span>
<span id="cb149-594"><a href="#cb149-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-595"><a href="#cb149-595" aria-hidden="true" tabindex="-1"></a>Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</span>
<span id="cb149-596"><a href="#cb149-596" aria-hidden="true" tabindex="-1"></a>R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>