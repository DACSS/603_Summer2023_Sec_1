---
title: "Class Project 1"
author: "Erika Nagai"
desription: "First iteration of the class project"
date: "07/18/2023"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - final project
  - Erika Nagai
  - dplyr
  
---

```{r}
#| label: setup
#| warning: false

library(tidyverse)
library(dplyr)

knitr::opts_chunk$set(echo = TRUE)
```
## Instructions

1. Import data into R and load the `dplyr` package to perform the following descriptive analysis on the two variables you are working with:
    
    i) Start by first [plotting]{.underline} the probability as well as cumulative density functions for each of your variables as shown in chapter 2. Instead of using sample() to generate a vector of probabilities, designate ‘probability’ to be the observations in your dataset. You may search online for simple ways to generate these plots for you data.
    
    ii) Group data by the two variables of interest to you (and relevance to the phenomenon you are interested in exploring) and obtain mean and standard deviation for at least one of the variables like in the example below. Please also print your results, as they will be important for your final writeup. 
    
    ![](images_Qasim/image1.png){fig-align="center"}
    
    iii) Split both of your variables like illustrated in the example below. You may use ‘greater than’ or ‘less than’ signs to split your data
    
    ![](images_Qasim/image2.png){fig-align="center"}
    
    iv) Rename columns according to the splits you’ve made and obtain difference in means along with standard errors and confidence intervals like so:
    
    ![](images_Qasim/image3.png){fig-align="center"}
    
    v) Now generate a plot by first designating X and Y according to the variable you would assign as an independent variable (regressor or X) and which one as a dependent variable (Y) like so:
    
    ![](images_Qasim/image4.png){fig-align="center"}
    
2. Carry out simple regression analysis that employs lm() function to generate results for the analysis

    i) Generate plot that regresses you X variable on Y. Fit a line through the observations to capture the systematic relationship:
    
     ![](images_Qasim/image5.png){fig-align="center"}

## Overview:

This analysis was done for in-class assignment for DACSS 603 Introduction to Quantitative Analysis at the University of Massachusetts, Amherst.

My analysis is about Japanese moviegoers' behavior and trend over last 20 years. As this article (https://www.washingtonpost.com/business/avatar-struggles-show-how-japan-is-ditching-hollywood/2022/12/22/09197536-8234-11ed-8738-ed7217de2775_story.html) suggests, recent Hollywood movies are struggling in Japanese market. This might suggest that Japanese people are favoring domestic movies because they are getting more close-minded or Japanese movie industry is getting mature and more attractive for Japanese audience.

My research questions are:

1.  How has Japanese moviegoers' behavior changed over 20 years?
2.  What kind of movies attract Japanese movies?

## Dataset

I gathered the data of the movies that were among top 130 in box office revenue in Japan for the last 20 years (2002-2022) by scraping data available on Box Office Mojo by IMDbPro (https://www.boxofficemojo.com/year/2022/?area=JP&grossesOption=totalGrosses&sort=rank&sortDir=asc) \* 2022 should be changed to the year you want to refer to.

Besides, I used the dataset (https://www.kaggle.com/datasets/akshaypawar7/millions-of-movies) as of July 14th, 2023 to complement useful information on movies' language and genres.

```{r}

# load packages
library(dplyr)
library(ggplot2)
#install.packages("tidyverse")
library(tidyverse)

```

```{r}
# Read in data
df <- read_csv("data_ErikaNagai/movies_update.csv")
df <- df %>% arrange(total_gross)

str(df)
```

## EDA (1st Homework)

This dataset contains 3219 rows (movies) that were among top 148 movies with the highest box office revenues in Japan every year between 2002 and 2022.

It contains basic information about movies such as total gross box office revenue, release date in Japan, original language, genres, and some movies have their tagline as well

**Instruction a**. Start by first plotting the probability as well as cumulative density functions for each of your variables as shown in chapter 2. Instead of using sample() to generate a vector of probabilities, designate 'probability' to be the observations in your dataset. You may search online for simple ways to generate these plots for you data.

The below is a probability of a movie having a specific value. As the probability of a moving having a specific value is quite low (close to 0), the plot looks flat.

```{r}
# probability density of Box Office revenue in Japan 


probability <- rep(1/3219, 3219)

plot(x = df$total_gross,
     y = probability,
     main = 'Probability Distribution Function',
     xlab = 'Total Box Office Revenue in Japan (USD)',
     ylab = 'Probability')

```

```{r}

cum_probability <- cumsum(probability)
plot(x = df$total_gross,
     y = cum_probability,
     main = 'Cumulative Probability Distribution Function',
     xlab = 'Total Box Office Revenue in Japan (USD)',
     ylab = 'Cumulative Probability')


```

**Instruction b**. Group data by the two variables of interest to you (and relevance to the phenomenon you are interested in exploring) and obtain mean and standard deviation for at least one of the variables like in the example below. Please also print your results, as they will be important for your final writeup.

```{r}
print(summary(df$total_gross))
```

```{r}
print(sd(df$total_gross))
```

**Introduction c**. Split both of your variables like illustrated in the example below. You may use 'greater than' or 'less than' signs to split your data

## Statistics description of box office revenue of **foreign movies in Japan**

```{r}
df_foreign <- df %>% 
  filter(region == "Foreign")

summary(df_foreign$total_gross)

```

Standard deviation of box office revenue of foreign movies in Japan

```{r}
sd(df_foreign$total_gross)
```

## Statistics description of box office revenue of **domestic movies in Japan**

```{r}
df_domestic <- df %>% 
  filter(region == "Japan")

summary(df_domestic$total_gross)

```

```{r}
sd(df_domestic$total_gross)
```

**Instruction d.** Rename columns according to the splits you've made and obtain difference in means along with standard errors and confidence intervals like so:

The mean of Box Office revenue of domestic movies are bigger than that of foreign movies.

```{r}

# Difference in means
gap_mean <- mean(df_domestic$total_gross) - mean(df_foreign$total_gross)

gap_se <- sqrt(df_domestic$total_gross/count(df_domestic) + df_foreign$total_gross/count(df_domestic))

gap_ci_l <- gap_mean - 1.96 * gap_se
gap_ci_u <- gap_mean + 1.96 * gap_se

results = cbind(gap_mean, gap_se, gap_ci_l, gap_ci_u)
colnames(results) <- c("gap_mean", "gap_se", "gap_ci_l", "gap_ci_u")
print(results)
```

**Instruction e.** assign as an independent variable (regressor or X) and which one as a dependent variable (Y) like so:

My independent variable (foreign/domestic) is a discrete variable, so I used histogram instead to show the difference of distribution between foreign movies and domestic movies.

```{r}
df %>%
  ggplot(aes(x = total_gross)) +
  geom_histogram(bins=50, fill='lightblue') +
  facet_wrap(~region) +
  labs(title="Distribution of Box Office Revenue in Japan",
       x = "Box Office Revenue in Japan (USD")


```

**Instruction.** Carry out simple regression analysis that employs lm() function to generate results for the analysis a. Generate plot that regresses you X variable on Y. Fit a line through the observations to capture the systematic relationship:

My independent variable is discrete so the linear regression (box office revenue \~ region) used dummy variables.

This regression model basically shows the mean box office revenue by movie regions (unknown, foreign, japan). On average, both Foreign and Japanese movies are likely to make statistically higher box office revenue than movies whose original region is unknown.

```{r}
df$region <- factor(df$region, levels=c("Unknown", "Foreign", "Japan"))
model <- lm(df$total_gross~ df$region)
summary(model)
```

Since my independent variable is NOT continuous, it is difficult to plot the regression model. Thus, I prepared the boxplot graph that show the difference in box offixe revenue depending on the regional origin of the movies (Unknown, Foreign, Japan)

```{r}
plot(df$total_gross ~ df$region)

```
