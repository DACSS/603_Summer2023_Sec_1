{
  "hash": "e41f0d6926e29ded55246bf4fe96eb2d",
  "result": {
    "markdown": "---\ntitle: \"Class Project Assignment 1\"\nauthor: \"Matt Eckstein\"\ndesription: \"Religious Identification as Orthodox Christian vs. Approval of US Leadership in the World\"\ndate: \"07/10/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - challenge1\n  - my name\n  - dataset\n  - ggplot2 \n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n\n\n# Loading packages and reading in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(readxl)\n\ndata <- read_csv(\"Eckstein_data/Orthodoxy_and_US_leadership_cleaned.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 70 Columns: 15\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (5): Country, Estimated 2010\nCatholic Population, Estimated 2010\nProtest...\ndbl (8): bordru, bordua, bordruua, pctox, approve, disapprove, dkref, netapp...\nnum (2): Estimated 2010\nOrthodox Population, totalpop\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndata$pctox <- data$pctox * 100\n```\n:::\n\n\n# Plotting probability and cumulative density functions for variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Probability distribution of percent Orthodox by country\n\nprobability <- data$pctox\n\nbarplot(probability, \n        xlab = \"Countries by Orthodox Christian Share of Population\", \n        col = \"steelblue\", \n        space = 0, \n        main = \"Orthodoxy by Country\")\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Probability distribution of net approval by country\n\nprobability2 <- data$netapprove\n\nbarplot(probability2, \n        xlab = \"Net Approval of US World Leadership by Country\", \n        col = \"steelblue\", \n        space = 0, \n        main = \"Approval of US Leadership, by Country\")\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Cumulative distribution of the percentage of Orthodox Christians by country\n\nplot(ecdf(data$pctox))\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Cumulative distribution of the net approval rating by country of US leadership in the world\nplot(ecdf(data$netapprove))\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n:::\n\nThe probability density plot of countries by the shares of their populations that identify as Orthodox Christian is notably right-skewed (and the CDF plot of countries by percent Orthodox Christian has many points clustered at the left edge, near the zero value of the horizontal axis) because the distribution of Orthodoxy throughout the world is highly uneven. Only a few countries, mostly in Eastern Europe, have high percentages of their populations that identify with Orthodoxy, while considerably more countries have small minorities consisting of less than two percent of their populations that identify with Orthodoxy.\n\nOn the other hand, the plots of net approval by country of US leadership indicate a more even distribution, with a handful of countries where US leadership is extremely popular, a handful where it is extremely unpopular, and many others in between where public opinion towards US leadership is mixed.\n\n# Creating buckets by which to group data, to facilitate the data grouping step\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a vector to store the oxbucket values\noxbucket <- character(length(data$pctox))\n\n# Assign values to oxbucket based on pctox\noxbucket[data$pctox < 2] <- \"<2%\"\noxbucket[data$pctox >= 2 & data$pctox < 5] <- \"2-5%\"\noxbucket[data$pctox >= 5 & data$pctox < 10] <- \"5-10%\"\noxbucket[data$pctox >= 10 & data$pctox < 25] <- \"10-25%\"\noxbucket[data$pctox >= 25 & data$pctox < 50] <- \"25-50%\"\noxbucket[data$pctox >= 50 & data$pctox < 75] <- \"50-75%\"\noxbucket[data$pctox >= 75 & data$pctox < 100] <- \"75-100%\"\n\n# Add the oxbucket variable to the data frame\ndata$oxbucket <- oxbucket\n```\n:::\n\n\n\n# Grouping data by variables of interest, obtaining mean and standard deviation\n\n::: {.cell}\n\n```{.r .cell-code}\navgs <- data %>%\n  group_by(bordruua, oxbucket) %>%\n  summarize(mean(netapprove),\n  sd(netapprove),\n  n())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'bordruua'. You can override using the\n`.groups` argument.\n```\n:::\n:::\n\n# Splitting variables by category\n\n\n::: {.cell}\n\n```{.r .cell-code}\nborder <- avgs %>% dplyr::filter(bordruua == 1)\nnoborder <- avgs %>% dplyr::filter(bordruua == 0)\n```\n:::\n\n\n\n\n# Renaming columns\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(border) <- c(\"Border_war\", \"Percent_orthodox\", \"mean_net_approval\", \"SD_net_approval\", \"number\")\ncolnames(noborder) <- c(\"Border_war\", \"Percent_orthodox\", \"mean_net_approval\", \"SD_net_approval\", \"number\")\n```\n:::\n\n\n\n# Estimating gaps\n\n::: {.cell}\n\n```{.r .cell-code}\ngap <- border$mean_net_approval - noborder$mean_net_approval\n\ngap_se <- sqrt(border$SD_net_approval^2 / border$number + noborder$SD_net_approval^2 / noborder$number)\n\ngap_ci_l <- gap - 1.96 * gap_se\n\ngap_ci_u <- gap + 1.96 * gap_se\n\nresult <- cbind(border[,-1], noborder[-(1:2)], gap, gap_se, gap_ci_l, gap_ci_u)\n\n\nprint(result, digits = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Percent_orthodox mean_net_approval SD_net_approval number mean_net_approval\n1           10-25%              1.67            11.0      3             -15.4\n2             2-5%              3.00              NA      1             -12.0\n3            5-10%             20.00              NA      1              23.0\n4           50-75%            -73.00              NA      1             -20.0\n5          75-100%             15.25            25.8      4             -23.0\n6              <2%              1.50            38.8      8               2.5\n  SD_net_approval number   gap gap_se gap_ci_l gap_ci_u\n1           16.02      5  17.1   9.58    -1.71     35.8\n2           12.73      2  15.0     NA       NA       NA\n3           54.17      4  -3.0     NA       NA       NA\n4            5.57      3 -53.0     NA       NA       NA\n5           37.82      4  38.2  22.88    -6.59     83.1\n6           34.66     34  -1.0  14.95   -30.30     28.3\n```\n:::\n:::\n\n\n# Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(data$pctox,\n     data$netapprove,\n     type = \"p\",\n     main = \"Countries: Percent Orthodox Christian vs. Net Approval of US Leadership\",\n     cex.main = 1,\n     xlab = \"Percent Orthodox\",\n     ylab = \"Net Approval of US Leadership\",\n     col = \"steelblue\",\n     pch = 19)\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n# Regression\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(data$netapprove ~ data$pctox)\nplot2 <- plot(data$netapprove ~ data$pctox)\n\nabline(a = 2.438959, b = -0.1798092)\n```\n\n::: {.cell-output-display}\n![](Eckstein_class_project_assignment_1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nThe plot of countries by the percentages of their populations that identify as Orthodox Christian vs. their levels of net approval of US leadership has a regression line with a slope of -0.1798, demonstrating a slight negative relationship between the shares of countries' populations that identify as Orthodox and their levels of net approval of US leadership.\n\n\n\n",
    "supporting": [
      "Eckstein_class_project_assignment_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}