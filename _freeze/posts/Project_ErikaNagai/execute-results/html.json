{
  "hash": "6174e5da66c7f4bdfd7cb381b30cca58",
  "result": {
    "markdown": "---\ntitle: \"Class Project 1\"\nauthor: \"Erika Nagai\"\ndesription: \"First iteration of the class project\"\ndate: \"07/18/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - final project\n  - Erika Nagai\n  - dplyr\n  \n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dplyr)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n## Instructions\n\n1. Import data into R and load the `dplyr` package to perform the following descriptive analysis on the two variables you are working with:\n    \n    i) Start by first [plotting]{.underline} the probability as well as cumulative density functions for each of your variables as shown in chapter 2. Instead of using sample() to generate a vector of probabilities, designate ‘probability’ to be the observations in your dataset. You may search online for simple ways to generate these plots for you data.\n    \n    ii) Group data by the two variables of interest to you (and relevance to the phenomenon you are interested in exploring) and obtain mean and standard deviation for at least one of the variables like in the example below. Please also print your results, as they will be important for your final writeup. \n    \n    ![](images_Qasim/image1.png){fig-align=\"center\"}\n    \n    iii) Split both of your variables like illustrated in the example below. You may use ‘greater than’ or ‘less than’ signs to split your data\n    \n    ![](images_Qasim/image2.png){fig-align=\"center\"}\n    \n    iv) Rename columns according to the splits you’ve made and obtain difference in means along with standard errors and confidence intervals like so:\n    \n    ![](images_Qasim/image3.png){fig-align=\"center\"}\n    \n    v) Now generate a plot by first designating X and Y according to the variable you would assign as an independent variable (regressor or X) and which one as a dependent variable (Y) like so:\n    \n    ![](images_Qasim/image4.png){fig-align=\"center\"}\n    \n2. Carry out simple regression analysis that employs lm() function to generate results for the analysis\n\n    i) Generate plot that regresses you X variable on Y. Fit a line through the observations to capture the systematic relationship:\n    \n     ![](images_Qasim/image5.png){fig-align=\"center\"}\n\n## Overview:\n\nThis analysis was done for in-class assignment for DACSS 603 Introduction to Quantitative Analysis at the University of Massachusetts, Amherst.\n\nMy analysis is about Japanese moviegoers' behavior and trend over last 20 years. As this article (https://www.washingtonpost.com/business/avatar-struggles-show-how-japan-is-ditching-hollywood/2022/12/22/09197536-8234-11ed-8738-ed7217de2775_story.html) suggests, recent Hollywood movies are struggling in Japanese market. This might suggest that Japanese people are favoring domestic movies because they are getting more close-minded or Japanese movie industry is getting mature and more attractive for Japanese audience.\n\nMy research questions are:\n\n1.  How has Japanese moviegoers' behavior changed over 20 years?\n2.  What kind of movies attract Japanese movies?\n\n## Dataset\n\nI gathered the data of the movies that were among top 130 in box office revenue in Japan for the last 20 years (2002-2022) by scraping data available on Box Office Mojo by IMDbPro (https://www.boxofficemojo.com/year/2022/?area=JP&grossesOption=totalGrosses&sort=rank&sortDir=asc) \\* 2022 should be changed to the year you want to refer to.\n\nBesides, I used the dataset (https://www.kaggle.com/datasets/akshaypawar7/millions-of-movies) as of July 14th, 2023 to complement useful information on movies' language and genres.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(dplyr)\nlibrary(ggplot2)\n#install.packages(\"tidyverse\")\nlibrary(tidyverse)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data\ndf <- read_csv(\"data_ErikaNagai/movies_update.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 3219 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (13): title, distributor, title_short, genres, original_language, overv...\ndbl  (11): gross, total_gross, release_year_JP, id, popularity, budget, reve...\nlgl   (1): re_released\ndate  (2): release_date_JP, release_date_World\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndf <- df %>% arrange(total_gross)\n\nstr(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [3,219 × 27] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ title               : chr [1:3219] \"Down a Dark Hall\" \"Equals\" \"Shin Godzilla2019 Re-release\" \"6 Below: Miracle on the Mountain\" ...\n $ gross               : num [1:3219] 1686 3087 4640 2083 8888 ...\n $ total_gross         : num [1:3219] 1686 3087 4640 7500 8888 ...\n $ distributor         : chr [1:3219] \"-\" \"Twin Film\" \"-\" \"The Klockworx\" ...\n $ release_date_JP     : Date[1:3219], format: \"2019-01-04\" \"2017-03-04\" ...\n $ release_year_JP     : num [1:3219] 2019 2017 2020 2018 2019 ...\n $ title_short         : chr [1:3219] \"downadarkhall\" \"equals\" \"shingodzilla\" \"6below:miracleonthemountain\" ...\n $ re_released         : logi [1:3219] FALSE FALSE TRUE FALSE FALSE FALSE ...\n $ id                  : num [1:3219] 421792 301875 315011 423087 468213 ...\n $ genres              : chr [1:3219] \"Thriller-Drama-Fantasy-Horror\" \"Drama-Romance-Science Fiction\" \"Action-Science Fiction-Horror\" \"Thriller-Drama\" ...\n $ original_language   : chr [1:3219] \"en\" \"en\" \"ja\" \"en\" ...\n $ overview            : chr [1:3219] \"Kit a troubled girl is sent to the exclusive Blackwood boarding school where she discovers that only four other\"| __truncated__ \"A futuristic love story set in a world where emotions have been eradicated.\" \"When a massive gilled monster emerges from the deep and tears through the city the government scrambles to save\"| __truncated__ \"An adrenaline seeking snowboarder gets lost in a massive winter storm in the back country of the High Sierras w\"| __truncated__ ...\n $ popularity          : num [1:3219] 15.42 9.39 35.4 18.23 5.7 ...\n $ production_companies: chr [1:3219] \"Nostromo Pictures-Temple Hill Entertainment-Fickle Fish Films\" \"Scott Free Productions-Infinite Studios-Freedom Media-Route One Entertainment\" NA \"Dune Entertainment-Sonar Entertainment-Stormchaser Films-Tucker Tooley Entertainment-October Sky Films\" ...\n $ release_date_World  : Date[1:3219], format: \"2018-08-01\" \"2015-07-15\" ...\n $ budget              : num [1:3219] 0.0 1.6e+07 1.5e+07 0.0 0.0 0.0 2.0e+07 0.0 5.0e+07 2.5e+07 ...\n $ revenue             : num [1:3219] 2707199 2084628 77947607 0 0 ...\n $ runtime             : num [1:3219] 96 102 120 97 140 103 85 94 86 110 ...\n $ status              : chr [1:3219] \"Released\" \"Released\" \"Released\" \"Released\" ...\n $ tagline             : chr [1:3219] \"Welcome to Blackwood. Where lost girls find their way.\" \"Find your equal.\" \"A god incarnate. A city Doomed.\" \"Miracle on the Mountain\" ...\n $ vote_average        : num [1:3219] 5.5 6.1 7.1 5.8 6.83 ...\n $ vote_count          : num [1:3219] 600 1252 902 322 62 ...\n $ credits             : chr [1:3219] \"AnnaSophia Robb-Uma Thurman-Isabelle Fuhrman-Victoria Moroles-Noah Silver-Taylor Russell-Rosie Day-Rebecca Fron\"| __truncated__ \"Nicholas Hoult-Kristen Stewart-Guy Pearce-Jacki Weaver-Bel Powley-Claudia Kim-Scott Lawrence-Toby Huss-Kate Lyn\"| __truncated__ \"Hiroki Hasegawa-Yutaka Takenouchi-Satomi Ishihara-Kengo Kora-Satoru Matsuo-Mikako Ichikawa-Issey Takahashi-Kanj\"| __truncated__ \"Josh Hartnett-Mira Sorvino-Sarah Dumont-Kale Culley-Jason Cottle-Austin R. Grant-Nathan Stevens-Marty McSorely-\"| __truncated__ ...\n $ _merge              : chr [1:3219] \"both\" \"both\" \"both\" \"both\" ...\n $ date_difference     : chr [1:3219] \"156 days\" \"598 days\" \"1387 days\" \"282 days\" ...\n $ region              : chr [1:3219] \"Foreign\" \"Foreign\" \"Japan\" \"Foreign\" ...\n $ anime               : num [1:3219] 0 0 0 0 0 0 0 0 1 0 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   title = col_character(),\n  ..   gross = col_double(),\n  ..   total_gross = col_double(),\n  ..   distributor = col_character(),\n  ..   release_date_JP = col_date(format = \"\"),\n  ..   release_year_JP = col_double(),\n  ..   title_short = col_character(),\n  ..   re_released = col_logical(),\n  ..   id = col_double(),\n  ..   genres = col_character(),\n  ..   original_language = col_character(),\n  ..   overview = col_character(),\n  ..   popularity = col_double(),\n  ..   production_companies = col_character(),\n  ..   release_date_World = col_date(format = \"\"),\n  ..   budget = col_double(),\n  ..   revenue = col_double(),\n  ..   runtime = col_double(),\n  ..   status = col_character(),\n  ..   tagline = col_character(),\n  ..   vote_average = col_double(),\n  ..   vote_count = col_double(),\n  ..   credits = col_character(),\n  ..   `_merge` = col_character(),\n  ..   date_difference = col_character(),\n  ..   region = col_character(),\n  ..   anime = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n\n## EDA (1st Homework)\n\nThis dataset contains 3219 rows (movies) that were among top 148 movies with the highest box office revenues in Japan every year between 2002 and 2022.\n\nIt contains basic information about movies such as total gross box office revenue, release date in Japan, original language, genres, and some movies have their tagline as well\n\n**Instruction a**. Start by first plotting the probability as well as cumulative density functions for each of your variables as shown in chapter 2. Instead of using sample() to generate a vector of probabilities, designate 'probability' to be the observations in your dataset. You may search online for simple ways to generate these plots for you data.\n\nThe below is a probability of a movie having a specific value. As the probability of a moving having a specific value is quite low (close to 0), the plot looks flat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# probability density of Box Office revenue in Japan \n\n\nprobability <- rep(1/3219, 3219)\n\nplot(x = df$total_gross,\n     y = probability,\n     main = 'Probability Distribution Function',\n     xlab = 'Total Box Office Revenue in Japan (USD)',\n     ylab = 'Probability')\n```\n\n::: {.cell-output-display}\n![](Project_ErikaNagai_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncum_probability <- cumsum(probability)\nplot(x = df$total_gross,\n     y = cum_probability,\n     main = 'Cumulative Probability Distribution Function',\n     xlab = 'Total Box Office Revenue in Japan (USD)',\n     ylab = 'Cumulative Probability')\n```\n\n::: {.cell-output-display}\n![](Project_ErikaNagai_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n**Instruction b**. Group data by the two variables of interest to you (and relevance to the phenomenon you are interested in exploring) and obtain mean and standard deviation for at least one of the variables like in the example below. Please also print your results, as they will be important for your final writeup.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(summary(df$total_gross))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n     1686   1389612   4500000  10675179  11323219 364777208 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(sd(df$total_gross))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19617649\n```\n:::\n:::\n\n\n**Introduction c**. Split both of your variables like illustrated in the example below. You may use 'greater than' or 'less than' signs to split your data\n\n## Statistics description of box office revenue of **foreign movies in Japan**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_foreign <- df %>% \n  filter(region == \"Foreign\")\n\nsummary(df_foreign$total_gross)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n     1686   1082826   3689582  10283637  10375104 249036646 \n```\n:::\n:::\n\n\nStandard deviation of box office revenue of foreign movies in Japan\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(df_foreign$total_gross)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19239505\n```\n:::\n:::\n\n\n## Statistics description of box office revenue of **domestic movies in Japan**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_domestic <- df %>% \n  filter(region == \"Japan\")\n\nsummary(df_domestic$total_gross)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n     4640   2312990   5990738  12345414  13650652 364777208 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(df_domestic$total_gross)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 22099730\n```\n:::\n:::\n\n\n**Instruction d.** Rename columns according to the splits you've made and obtain difference in means along with standard errors and confidence intervals like so:\n\nThe mean of Box Office revenue of domestic movies are bigger than that of foreign movies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Difference in means\ngap_mean <- mean(df_domestic$total_gross) - mean(df_foreign$total_gross)\n\ngap_se <- sqrt(df_domestic$total_gross/count(df_domestic) + df_foreign$total_gross/count(df_domestic))\n\ngap_ci_l <- gap_mean - 1.96 * gap_se\ngap_ci_u <- gap_mean + 1.96 * gap_se\n\nresults = cbind(gap_mean, gap_se, gap_ci_l, gap_ci_u)\ncolnames(results) <- c(\"gap_mean\", \"gap_se\", \"gap_ci_l\", \"gap_ci_u\")\nprint(results)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gap_mean   gap_se gap_ci_l gap_ci_u\n1  2061777 2.249622  2061773  2061781\n```\n:::\n:::\n\n\n**Instruction e.** assign as an independent variable (regressor or X) and which one as a dependent variable (Y) like so:\n\nMy independent variable (foreign/domestic) is a discrete variable, so I used histogram instead to show the difference of distribution between foreign movies and domestic movies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = total_gross)) +\n  geom_histogram(bins=50, fill='lightblue') +\n  facet_wrap(~region) +\n  labs(title=\"Distribution of Box Office Revenue in Japan\",\n       x = \"Box Office Revenue in Japan (USD\")\n```\n\n::: {.cell-output-display}\n![](Project_ErikaNagai_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n**Instruction.** Carry out simple regression analysis that employs lm() function to generate results for the analysis a. Generate plot that regresses you X variable on Y. Fit a line through the observations to capture the systematic relationship:\n\nMy independent variable is discrete so the linear regression (box office revenue \\~ region) used dummy variables.\n\nThis regression model basically shows the mean box office revenue by movie regions (unknown, foreign, japan). On average, both Foreign and Japanese movies are likely to make statistically higher box office revenue than movies whose original region is unknown.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$region <- factor(df$region, levels=c(\"Unknown\", \"Foreign\", \"Japan\"))\nmodel <- lm(df$total_gross~ df$region)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = df$total_gross ~ df$region)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-12340774  -9132666  -5883981    869547 352431794 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       7048139     969140   7.273 4.41e-13 ***\ndf$regionForeign  3235498    1088101   2.974  0.00297 ** \ndf$regionJapan    5297275    1115817   4.747 2.15e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19550000 on 3216 degrees of freedom\nMultiple R-squared:  0.007332,\tAdjusted R-squared:  0.006715 \nF-statistic: 11.88 on 2 and 3216 DF,  p-value: 7.254e-06\n```\n:::\n:::\n\n\nSince my independent variable is NOT continuous, it is difficult to plot the regression model. Thus, I prepared the boxplot graph that show the difference in box offixe revenue depending on the regional origin of the movies (Unknown, Foreign, Japan)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(df$total_gross ~ df$region)\n```\n\n::: {.cell-output-display}\n![](Project_ErikaNagai_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Project_ErikaNagai_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}