{
  "hash": "852524d6f7b3fc7ed66ecf04a6e7502d",
  "result": {
    "markdown": "---\ntitle: \"603 Class Project 1\"\nauthor: \"Kopecky\"\ndesription: \"General Social Survey\"\ndate: \"07/18/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Final Project\n  - Kopecky\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# libraries\nlibrary(dplyr)\nlibrary(MASS)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(stats)\nlibrary(readr)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## 1 Import Data and Descriptive Analysis\nThis dataset is from the General Social Survey (GSS) which has conducted research from 1972 on American Society. There are 15266 obervations (rows) with 6 variables (columns). The variables are *year*, *age*, *gender*, *race*, *fehelp*, and *era*. \n\nFor variable *fehelp*, repsondents state whether they 1=Strongly Agree to 4 = Strongly Disagree with the statement, \"It is more for a wife to help her husband's career than to have one herself.\" \n\nFor *era*, repsondents state whether they 1=Strongly Favor to 4 = Strongly Oppose the Equal Rights Amendment (ERA). \n\nThis project will look at the two variables *fehelp* and *year* but possibly explore the others. One question to ask is how has the level of agreement for *fehelp* changed over time.  \n\nThis seems to be a relevent question today as the Covid-19 pandemic highlighted the stress of balancing family and work. The National Women's Law Center (2022) states women left the workforce at a disproportionate rate and have not yet recovered. This is a concern because of lost skills, wages, and earning potential. https://nwlc.org/wp-content/uploads/2022/03/FINAL-NWLC-Resilient-But-Not-Recovered-3.29.22.pdf\n\nAdditionally, the BBC (2023) reports, \"Researchers for Deloitte’s Women @ Work 2023 report surveyed 5,000 women across 10 countries, 98% of whom were in heterosexual relationships. The data found that nearly 40% of respondents say their partner’s career takes precedence. They cited several reasons, ranging from financial and social factors to the burden of caretaking and household responsibilities. https://www.bbc.com/worklife/article/20230620-why-many-women-prioritise-their-partners-jobs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGSS <- read_csv(\"Nanci_datafolder/GSS.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 15266 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): era\ndbl (5): year, age, sex, race, fehelp\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nGSS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 15,266 × 6\n    year   age   sex  race fehelp era  \n   <dbl> <dbl> <dbl> <dbl>  <dbl> <chr>\n 1  1977    63     2     1      2 2    \n 2  1977    31     2     1      1 .i   \n 3  1977    66     1     1      1 2    \n 4  1977    26     1     1      4 1    \n 5  1977    20     2     1      3 2    \n 6  1977    36     1     1      3 2    \n 7  1977    77     2     1      2 2    \n 8  1977    35     2     1      1 2    \n 9  1977    85     2     1      3 .d   \n10  1977    44     2     1      3 2    \n# … with 15,256 more rows\n```\n:::\n\n```{.r .cell-code}\nhead(GSS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n   year   age   sex  race fehelp era  \n  <dbl> <dbl> <dbl> <dbl>  <dbl> <chr>\n1  1977    63     2     1      2 2    \n2  1977    31     2     1      1 .i   \n3  1977    66     1     1      1 2    \n4  1977    26     1     1      4 1    \n5  1977    20     2     1      3 2    \n6  1977    36     1     1      3 2    \n```\n:::\n\n```{.r .cell-code}\ndim(GSS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 15266     6\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mutating *fehelp* to *fehelpI* by reversing the values 1=Strongly Agree through 4=Strongly Disagree to 1=Strongly Disagree through 4=Strongly Agree because it seems more intuitive for graphing. \nGSSI <- GSS %>% \n  mutate(fehelpI = case_when(\n    fehelp == 1 ~ 4, \n    fehelp == 2 ~ 3, \n    fehelp == 3 ~ 2, \n    fehelp == 4 ~ 1))\nhead(GSSI)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n   year   age   sex  race fehelp era   fehelpI\n  <dbl> <dbl> <dbl> <dbl>  <dbl> <chr>   <dbl>\n1  1977    63     2     1      2 2           3\n2  1977    31     2     1      1 .i          4\n3  1977    66     1     1      1 2           4\n4  1977    26     1     1      4 1           1\n5  1977    20     2     1      3 2           2\n6  1977    36     1     1      3 2           2\n```\n:::\n:::\n\n\n## 1i Density Functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Opinion on Husband's Career Pdf vs. Histogram\nprobability <- density(GSSI$fehelpI)\nplot(probability, main = \"Husband's Career A Priority\", xlab = \"Agreement 1=Strongly Agree to 4=Strongly Disagree\", \n       ylab  = \"Density\")\npolygon(probability, col = \"pink\", border = \"blue\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(GSSI$fehelpI, main = \"Husband's Career A Priority\", xlab = \"Agreement 1=Strongly Disagree to 4=Strongly Agree\", \n       ylab  = \"Density\", col = \"pink\", border = \"blue\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Opinion by Year Overlapping vs Separate Pdf's. This can show how the level of aggreement for *fehelpI* has shifted overtime from 1977 to 1998. \nggplot(GSSI, aes(fehelpI))+\n  geom_density((aes(fill=factor(year), alpha=0.1)))+\n  ggtitle(\"Husband's Career A Priority\")+\n  labs(x = \"Agreement 1=Strongly Disagree to 4=Strongly Agree\", \n       y= \"Density\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(GSSI, aes(fehelpI))+\n  geom_density(aes(fill=factor(year))) +\n  ggtitle(\"Husband's Career A Priority\")+\n  labs(x = \"Agreement 1=Strongly Disagree to 4=Strongly Agree\", \n       y= \"Density\")+\n  facet_wrap(~ year, ncol = 4)\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cdf's for *fehelpI*, a few perspectives of cdf's for ordinal data. \n# Cumulative proportions\nordinal_data <- ordered(GSSI$fehelpI)\ncumulative_proportions <- cumsum(table(ordinal_data)) / length(ordinal_data)\nplot(cumulative_proportions, type = \"s\", xlab = \"Agreement 1=Stongly Disagree to 4=Strongly Agree\", ylab = \"Cumulative Proportion\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Empirical cumulative distribution\ncdf <- ecdf(GSSI$fehelpI)\nplot(cdf, \n     col =\"blue\",\n     main = \"Husband's Career a Priority\", \n     xlab = \"Agreement 1=Strongly Disagree to 4=Strongly Agree\", \n     ylab = \"Cumulative Density Function\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Textbook reference using the function cumsum\ncdf_fehelp <- cumsum(GSSI$fehelpI)\nplot(cdf_fehelp,\n     xlab = \"Agreement 1=Stongly Disagree to 4=Strongly Agree\",\n     main = \"Cumulative Probability Distribution\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::\n\n\n## 1ii-iv Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Opinion on Husband's Career grouped by year.  This table displays the mean, median, standard deviation and confidence intervals for *fehelpI* The mean level of agreement about making the husband's career a priority changed from 3=Agree to 2=Disagree and the standard deviation changed from 0.80 in 1972 to 0.74 in 1996. \nGSSI %>% group_by(year) %>% \n  summarize(mean_fehelpI= mean(fehelpI),\n            median_fehelpI =median(fehelpI),\n            sd_fehelpI =sd(fehelpI), \n            ci_lower_fehelpI= t.test(fehelpI)$conf.int[1],\n            ci_upper_fehelpI = t.test(fehelpI)$conf.int[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 11 × 6\n    year mean_fehelpI median_fehelpI sd_fehelpI ci_lower_fehelpI ci_upper_fehe…¹\n   <dbl>        <dbl>          <dbl>      <dbl>            <dbl>           <dbl>\n 1  1977         2.65              3      0.801             2.60            2.69\n 2  1985         2.28              2      0.812             2.23            2.32\n 3  1986         2.25              2      0.804             2.21            2.30\n 4  1988         2.15              2      0.800             2.10            2.20\n 5  1989         2.13              2      0.793             2.08            2.18\n 6  1990         2.13              2      0.771             2.08            2.18\n 7  1991         2.13              2      0.760             2.08            2.18\n 8  1993         2.05              2      0.736             2.01            2.10\n 9  1994         2.02              2      0.733             1.99            2.05\n10  1996         2.00              2      0.741             1.97            2.03\n11  1998         1.96              2      0.720             1.93            2.00\n# … with abbreviated variable name ¹​ci_upper_fehelpI\n```\n:::\n:::\n\n\n## Descriptive Statistics continued\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Frequency and proportion tables of level of aggreement for *fehelpI* grouped by year\ntable(GSSI$year, GSSI$fehelpI)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n          1    2    3    4\n  1977   97  530  633  205\n  1985  241  676  453   96\n  1986  238  678  425   88\n  1988  199  466  253   47\n  1989  194  499  216   53\n  1990  182  457  230   35\n  1991  199  504  261   33\n  1993  222  574  213   33\n  1994  431 1055  350   59\n  1996  573 1275  419   73\n  1998  457  997  303   44\n```\n:::\n\n```{.r .cell-code}\nprop.table(table(GSSI$year, GSSI$fehelpI)) %>% {.*100} %>% round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n          1    2    3    4\n  1977 0.64 3.47 4.15 1.34\n  1985 1.58 4.43 2.97 0.63\n  1986 1.56 4.44 2.78 0.58\n  1988 1.30 3.05 1.66 0.31\n  1989 1.27 3.27 1.41 0.35\n  1990 1.19 2.99 1.51 0.23\n  1991 1.30 3.30 1.71 0.22\n  1993 1.45 3.76 1.40 0.22\n  1994 2.82 6.91 2.29 0.39\n  1996 3.75 8.35 2.74 0.48\n  1998 2.99 6.53 1.98 0.29\n```\n:::\n:::\n\n\n## Tidy data for scatterplot and linear regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Changing from numeric to character data\nGSSI$sex <- as.character(GSSI$sex)\n# Removing rows with non-numerical cell values for era variable. And reversing the values 1=Strongly Favor - 4=Strongly Oppose to 1=Strongly Oppose - 4=Strongly Favor because it seems more intuitive for graphing. This was only collected in 1972.\nGSSI_era <- GSSI[!(is.na(GSSI$era) | GSSI$era==\".i\"| GSSI$era==\".d\" | GSSI$era==\".n\"), ]\nunique(GSSI_era$era)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2\" \"1\" \"3\" \"4\"\n```\n:::\n\n```{.r .cell-code}\nGSSI_era$era <- as.factor(GSSI_era$era)\nGSSI_era <- GSSI_era %>% \n  mutate(eraI = case_when(\n    era == 1 ~ 4, \n    era == 2 ~ 3, \n    era == 3 ~ 2, \n    era == 4 ~ 1))\nhead(GSSI_era)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n   year   age sex    race fehelp era   fehelpI  eraI\n  <dbl> <dbl> <chr> <dbl>  <dbl> <fct>   <dbl> <dbl>\n1  1977    63 2         1      2 2           3     3\n2  1977    66 1         1      1 2           4     3\n3  1977    26 1         1      4 1           1     4\n4  1977    20 2         1      3 2           2     3\n5  1977    36 1         1      3 2           2     3\n6  1977    77 2         1      2 2           3     3\n```\n:::\n\n```{.r .cell-code}\nstr(GSSI_era)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [1,156 × 8] (S3: tbl_df/tbl/data.frame)\n $ year   : num [1:1156] 1977 1977 1977 1977 1977 ...\n $ age    : num [1:1156] 63 66 26 20 36 77 35 44 30 36 ...\n $ sex    : chr [1:1156] \"2\" \"1\" \"1\" \"2\" ...\n $ race   : num [1:1156] 1 1 1 1 1 1 1 1 1 1 ...\n $ fehelp : num [1:1156] 2 1 4 3 3 2 1 3 1 3 ...\n $ era    : Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 2 2 1 2 2 2 2 2 1 1 ...\n $ fehelpI: num [1:1156] 3 4 1 2 2 3 4 2 4 2 ...\n $ eraI   : num [1:1156] 3 3 4 3 3 3 3 3 4 4 ...\n```\n:::\n\n```{.r .cell-code}\ndim(GSSI_era)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1156    8\n```\n:::\n:::\n\n\n## 1v. Scatterplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# *era* is the dependent variable and *fehelpI* is the independent variable.  The position_jitter function was used to visualize the overlapping points. \nGSSI_era %>% ggplot(aes(eraI, fehelpI, fill = sex))+\n  geom_point(shape = 21, size = 1.5, position = position_jitter(width = 0.2, height = 0.2)) + \n  labs(x = \"Husband's Career a Priority 4=Strongly Agree\", y = \"In Favor of ERA 4=Strongly Favor\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Basic scatterplot with abline\nplot(GSSI_era$eraI,GSSI_era$fehelpI,main=\"Scatterplot\")\n```\n\n::: {.cell-output-display}\n![](603_Class_Project_1_Kopecky_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nabline(eraxfehelpI)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in abline(eraxfehelpI): object 'eraxfehelpI' not found\n```\n:::\n:::\n\n\n## 2 Linear Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\neraxfehelpI <- lm(GSSI_era$eraI~GSSI_era$fehelpI)\nsummary(eraxfehelpI)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = GSSI_era$eraI ~ GSSI_era$fehelpI)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.3939 -0.4030  0.2667  0.5970  1.5970 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       3.72424    0.08387   44.41   <2e-16 ***\nGSSI_era$fehelpI -0.33031    0.03072  -10.75   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8387 on 1154 degrees of freedom\nMultiple R-squared:  0.09104,\tAdjusted R-squared:  0.09025 \nF-statistic: 115.6 on 1 and 1154 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nr_correlation_coef <- cor(GSSI_era$fehelpI, GSSI_era$eraI)\nr2_coef_of_determination <- r_correlation_coef^2\neraxfehelpI$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     (Intercept) GSSI_era$fehelpI \n       3.7242365       -0.3303108 \n```\n:::\n\n```{.r .cell-code}\nprint(r_correlation_coef) # r=-0.30 represents a negative and weak association between the variables\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.3017318\n```\n:::\n\n```{.r .cell-code}\nprint(r2_coef_of_determination) # r^2=0.09 also shows a weak relationship between the variables such that only about 9% of the variation in *eraI* is determined by the variation in *fehelpI*\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.09104207\n```\n:::\n:::\n",
    "supporting": [
      "603_Class_Project_1_Kopecky_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}