{
  "hash": "4eccdd8bfd8b761333de2e929df8f6bf",
  "result": {
    "markdown": "---\ntitle: \"Class Project 2\"\nauthor: \"Erika Nagai\"\ndesription: \"Class Project 2\"\ndate: \"08/15/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - final project\n  - Erika Nagai\n  - dplyr\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\n#install.packages(\"gridExtra\")\nlibrary(gridExtra)\nlibrary(AER)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Overview:\n\nThis analysis was done for in-class assignment for DACSS 603 Introduction to Quantitative Analysis at the University of Massachusetts, Amherst.\n\nMy analysis is about Japanese moviegoers' behavior and trend over last 20 years. As this article (https://www.washingtonpost.com/business/avatar-struggles-show-how-japan-is-ditching-hollywood/2022/12/22/09197536-8234-11ed-8738-ed7217de2775_story.html) suggests, recent Hollywood movies are struggling in Japanese market. This might suggest that Japanese people are favoring domestic movies because they are getting more close-minded or Japanese movie industry is getting mature and more attractive for Japanese audience.\n\nMy research questions are:\n\nHow has Japanese moviegoers' behavior changed over 20 years?\n\nWhat kind of movies attract Japanese movies?\n\n## Dataset\n\nI used two datasets from two different sources.\n\n1.  By-year dataset (year) I gathered the data about general information (total box office revenue, total \\# of people who went to movie theaters, \\# of screens) of every year from 2000 to 2022. (http://www.eiren.org/statistics_e/index.html)\n\n2.  By-movie dataset ('ranking') I gathered the data of Top 100 movies in box office revenue in Japan for the last 20 years (2002-2022) by scraping data available on Box Office Mojo by IMDbPro (https://www.boxofficemojo.com/year/2022/?area=JP&grossesOption=totalGrosses&sort=rank&sortDir=asc) \\* 2022 should be changed to the year you want to refer to.\n\nThen, I added more detailed information about the movies using the dataset of movies available on TMdb (https://www.kaggle.com/datasets/akshaypawar7/millions-of-movies) as of July 14th, 2023 to complement useful information on movies' language and genres.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear <- read_csv(\"data_ErikaNagai/revised_year.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\nRows: 23 Columns: 15\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" dbl\n(15): ...1, year, total_screens, jp_movies, foreign_movies, total_movies...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nranking <- read_csv(\"data_ErikaNagai/merged_ranking.csv\") %>% \n  filter(rank <=100) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 3463 Columns: 35\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (17): original_title, release_date, distributor, revised_release_date, r...\ndbl (17): year, rank, gross, total_gross, order, release_year, id, JP_releas...\nlgl  (1): re_released\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nranking$anime <- as.factor(ranking$anime)\n```\n:::\n\n\n## Exploratory Analysis\n\n## Instructions by Professor Abbas:\n\n1.  **Write down multiple regression models as discussed in the lab. Please view the recordings for instructions on multicollinearity checks and OVB reduction as it pertains to model specification.**\n\nAs explained in the 'draft_final_project' file, 2008 marked a big shift in the Japanese moviegoers' trend because before 2008 foreign movies made more box office revenue in Japan than Japanese movies and after that the situation reversed and Japanese movies started making more revenue in Japan than foreign movies. Thus, I divided the data into two (2002-2007 vs. 2008-2020).\n\n**Multicollinearity:** No concern because there is only one numeric variable (global revenue)\n\n**Omitted Variable Bias:** I added a new column \"anime\", which indicates if the movie is animation or not, because many Japanese movies tend to have an animation format.\n\nI ran the following models:\n\n1.  box office revenue in Japan \\~ worldwide box office revenue + origin of movie + anime\n2.  box office revenue in Japan \\~ worldwide box office revenue + (worldwide box office revenue) \\^2 + origin of movie + anime\n3.  box office revenue in Japan \\~ log(worldwide box office revenue) + origin of movie + anime\n4.  box office revenue in Japan \\~ worldwide box office revenue + origin of movie + origin of movie \\* anime + anime\n5.  box office revenue in Japan \\~ worldwide box office revenue + worldwide box office revenue \\* anime + origin of movie + anime\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranking$global_revenue_squared <- (ranking$global_revenue)^2\nranking$global_revenue_log <- log(ranking$global_revenue)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nranking_before <- \n  ranking %>% filter(year < 2008)\n\nranking_after <-\n  ranking %>% filter(year >= 2008 & year <= 2020)\n```\n:::\n\n\n### 1. box office revenue in Japan \\~ worldwide box office revenue + origin of movie + anime\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1_before <- lm(gross~region+anime+global_revenue, data = ranking_before)\nlm1_after <- lm(gross~region+anime+global_revenue, data = ranking_after)\n\nlm1_before <- lm(gross~region+anime+global_revenue+global_revenue_squared, data = ranking_before)\nlm1_after <- lm(gross~region+anime+global_revenue+global_revenue_squared, data = ranking_after)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1_before <- lm(gross~region+anime+global_revenue, data = ranking_before)\nlm2_before <- lm(gross~region+anime+I(global_revenue^2), data = ranking_before)\nlm4_before <- lm(gross~region+anime+global_revenue+region*anime, data = ranking_before)\nlm5_before <- lm(gross~region+anime+global_revenue+anime*global_revenue, data = ranking_before)\n\n\nmodels_before <- list(lm1_before, lm2_before, lm4_before, lm5_before)\nmodel_names_before <- list(\"1. box office revenue in Japan ~ worldwide box office revenue + origin of movie + anime\", \n\"2. box office revenue in Japan ~ worldwide box office revenue + (worldwide box office revenue) ^2 + origin of movie + anime\",\n\"3. box office revenue in Japan ~ log(worldwide box office revenue) + origin of movie + anime\",\n\"4. box office revenue in Japan ~ worldwide box office revenue + origin of movie + origin of movie * anime + anime\",\n\"5.box office revenue in Japan ~ worldwide box office revenue + worldwide box office revenue * anime + origin of movie + anime\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(\"----------2002-2007------------\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"----------2002-2007------------\"\n```\n:::\n\n```{.r .cell-code}\nprint(\"1. box office revenue in Japan ~ worldwide box office revenue + origin of movie + anime\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1. box office revenue in Japan ~ worldwide box office revenue + origin of movie + anime\"\n```\n:::\n\n```{.r .cell-code}\nsummary(lm_before1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'lm_before1' not found\n```\n:::\n\n```{.r .cell-code}\nprint(coeftest(lm_before1, vcov. = vcovHC, type = \"HC1\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'lm_before1' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(\"----------2008-2020------------\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"----------2008-2020------------\"\n```\n:::\n\n```{.r .cell-code}\nprint(\"1. box office revenue in Japan ~ worldwide box office revenue + origin of movie + anime\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1. box office revenue in Japan ~ worldwide box office revenue + origin of movie + anime\"\n```\n:::\n\n```{.r .cell-code}\nsummary(lm_after)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'lm_after' not found\n```\n:::\n\n```{.r .cell-code}\nprint(coeftest(lm_after, vcov. = vcovHC, type = \"HC1\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'lm_after' not found\n```\n:::\n:::\n\n\n2.  **Upon writing your models, please follow the following steps that make your model-building strategy lends to both internal and external validity**\n\n    a.  The first step toward obtaining valid results is to get summary statistics for the data you are working with:\n\n    b.  Designate your regressors and report their mean and standard deviation:\n\n    c.  Estimate a basic linear equation and report summary:\n\n    d.  Estimate a basic linear equation and report summary:\n\n    e.  Attempt a log-linear model like so:\n\n    f.  Now attempt a cubic model:\n\n    g.  Plot the observations and add the linear, log-linear, as well as the cubic model like so:\n\n3.  **Explain if, visually speaking, a non-linear equation explains the relationship better than a linear model. Explain why, and how the visual plot influences your model specification strategy. Write an explanation that's at least two paragraphs long.**\n\n4.  **Now find the best model specification through the following steps:**\n\n    a.  Estimate multiple specifications that help address your research question like so:\n\n        -   \n\n            ```         \n            TestScore_MA_mod3 <- lm(score ~ STR + english + lunch + income + I(income^2) + I(income^3), data = MASchools)\n            ```\n\n        -   \n\n            ```         \n            TestScore_MA_mod4 <- lm(score ~ STR + I(STR^2) + I(STR^3) + english + lunch + income + I(income^2) + I(income^3), data = MASchools)\n            ```\n\n        -   \n\n            ```         \n            TestScore_MA_mod5 <- lm(score ~ STR + HiEL + I(income^2) + I(income^3) + HiEL:STR + lunch + income, data = MASchools)\n            ```\n\n        -   \n\n            ```         \n            TestScore_MA_mod6 <- lm(score ~ STR + I(income^2) + I(income^3)+ lunch + income, data = MASchools)\n            ```\n\n    b.  Obtain robust standard errors for each of your models like so:\n\n        -   \n\n            ```         \n            rob_se <- list(sqrt(diag(vcovHC(TestScore_MA_mod1, type = \"HC1\"))),\n             sqrt(diag(vcovHC(TestScore_MA_mod2, type = \"HC1\"))),\n             sqrt(diag(vcovHC(TestScore_MA_mod3, type = \"HC1\"))),\n             sqrt(diag(vcovHC(TestScore_MA_mod4, type = \"HC1\"))),\n             sqrt(diag(vcovHC(TestScore_MA_mod5, type = \"HC1\"))),\n             sqrt(diag(vcovHC(TestScore_MA_mod6, type = \"HC1\"))))\n            ```\n\n    c.  Using stargazer, report the results of your models like the following:\n\n        -   \n\n            ```         \n            library(stargazer)\n            ```\n\n        -   \n\n            ```         \n            stargazer(TestScore_MA_mod1, TestScore_MA_mod2, TestScore_MA_mod3, \n              TestScore_MA_mod4, TestScore_MA_mod5, TestScore_MA_mod6,\n              title = \"Regressions Using Massachusetts Test Score Data\",\n              type = \"latex\",\n              digits = 3,\n              header = FALSE,\n              se = rob_se,\n              object.names = TRUE,\n              model.numbers = FALSE,\n              column.labels = c(\"(I)\", \"(II)\", \"(III)\", \"(IV)\", \"(V)\", \"(VI)\"))\n            ```\n\n    d.  Now carry out a linear hypothesis test (F-Test) for EACH of your models by using the following example:\n\n        -   \n\n            ```         \n            linearHypothesis(TestScore_MA_mod3, \n               c(\"I(income^2)=0\", \"I(income^3)=0\"), \n               vcov. = vcovHC(TestScore_MA_mod3, type = \"HC1\"))\n            ```\n\n5.  **Explain which robust model best explains the relationship you've set out to investigate. Communicate your ideas so you can add them to a professional report. Think of your ideal employer. What would they want to know about your model? How would you go about interpreting the results, including the coefficients? Write several paragraphs that you might make part of a professional report---one that explains how your preferred model yields valid results both internally and externally in light of what you've earned in Chapter 9**\n\n## Panel data based analysis\n\nFrom here, I did time-series analysis that can be applied for panel data, following the advise from the professor Abbas and Chapter 10.4 of [\"Introduction to Econometrics\"]\n\nPanel data is defined as the data that \"consist of observations on multiple (n) entities \\... where each entity is observed at two or more time periods\" (Citation).\n\nI converted my dataset into panel-based dataset by grouping the box office revenue data by region and year. My new panel-based dataset consists of 2 entities (Japanese/Foreign movies) observed at 20 time periods (2000 - 2020).\n\nThe entity-fixed variable here is revenue_worldwide, anime_percentage because each movies' region have different characteristics.\n\nThe time-fixed variable here is Japanese people's willingness to watch movies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranking$anime <- as.integer(ranking$anime)\npanel <- ranking %>%\n  filter(year <= 2020 & region!='Unknown') %>%\n  group_by(year, region) %>%\n  summarize(revenue_japan = sum(gross),\n            revenue_worldwide = sum(global_revenue, na.rm = TRUE),\n            anime_percentage = sum(anime)/n())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\npanel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 38 × 5\n# Groups:   year [19]\n    year region  revenue_japan revenue_worldwide anime_percentage\n   <dbl> <chr>           <dbl>             <dbl>            <dbl>\n 1  2002 Foreign     841237717       12442093605             1.08\n 2  2002 Japan       205407170         394908270             1.56\n 3  2003 Foreign     931117495       13955083826             1.06\n 4  2003 Japan       345861186         569401916             1.30\n 5  2004 Foreign     914546672       14378198171             1.08\n 6  2004 Japan       482852142         360823820             1.36\n 7  2005 Foreign     818462314       13188496861             1.09\n 8  2005 Japan       385853353         275395864             1.46\n 9  2006 Foreign     598180535       11543391846             1.12\n10  2006 Japan       573493708         178568030             1.26\n# ℹ 28 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_panel <- lm(revenue_japan ~ year + region + anime_percentage + revenue_worldwide, data = panel)\nsummary(model_panel)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = revenue_japan ~ year + region + anime_percentage + \n    revenue_worldwide, data = panel)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-381724407 -152077991  -12253920  124373093  528694740 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)  \n(Intercept)        2.859e+07  1.242e+10   0.002   0.9982  \nyear               7.653e+05  6.240e+06   0.123   0.9031  \nregionJapan        5.293e+08  2.518e+08   2.102   0.0433 *\nanime_percentage  -1.054e+09  5.248e+08  -2.009   0.0528 .\nrevenue_worldwide  2.082e-02  1.345e-02   1.548   0.1311  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 197700000 on 33 degrees of freedom\nMultiple R-squared:  0.1684,\tAdjusted R-squared:  0.06766 \nF-statistic: 1.671 on 4 and 33 DF,  p-value: 0.1801\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nranking %>%\n  filter(is.na(global_revenue))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 448 × 37\n    year  rank original_title   gross total_gross release_date distributor order\n   <dbl> <dbl> <chr>            <dbl>       <dbl> <chr>        <chr>       <dbl>\n 1  2002     7 Harry Potter a… 4.85e7   152993493 1-Dec        -               1\n 2  2002    24 Toei Spring An… 1.31e7    13107237 2-Mar        -               1\n 3  2002    25 Mohou-han       1.17e7    11702775 8-Jun        -               1\n 4  2002    28 Kamen Rider Ry… 1.01e7    10112538 17-Aug       -               1\n 5  2002    34 Kureyon Shin-c… 8.73e6     8731473 20-Apr       -               1\n 6  2002    40 Totsunyûseyo! … 6.39e6     6394240 11-May       -               1\n 7  2002    46 Trick: The Mov… 5.31e6     9211504 9-Nov        -               1\n 8  2002    60 Ashita ga aru … 3.38e6     3379129 5-Oct        -               1\n 9  2002    61 Madness in Blo… 3.27e6     3265669 19-Oct       -               1\n10  2002    62 E.T. the Extra… 3.26e6     5837357 27-Apr       -               1\n# ℹ 438 more rows\n# ℹ 29 more variables: revised_release_date <chr>, release_year <dbl>,\n#   revised_title <chr>, re_released <lgl>, id <dbl>, JP_release_date <chr>,\n#   JP_release_year <dbl>, id_movies <dbl>, id_tmdb <dbl>, title <chr>,\n#   genres <chr>, original_language <chr>, overview <chr>, popularity <dbl>,\n#   production_companies <chr>, budget <dbl>, global_revenue <dbl>,\n#   runtime <dbl>, status <chr>, tagline <chr>, vote_average <dbl>, …\n```\n:::\n:::\n\n\n## 2008\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranking <- ranking %>%\n  mutate(\n    after_2008 = case_when(\n    year < 2008 ~ 0,\n    TRUE ~ 1\n  ),\n    year_number = year-2020)\n\n\nmodel1 <- lm(gross ~ region + anime + global_revenue + region*after_2008 + anime*after_2008 + global_revenue*after_2008, data = ranking)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = gross ~ region + anime + global_revenue + region * \n    after_2008 + anime * after_2008 + global_revenue * after_2008, \n    data = ranking)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-76199831  -7763777  -2252495   3659646 196059891 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                3.464e+06  2.462e+06   1.407 0.159611    \nregionJapan                1.425e+07  1.854e+06   7.685 2.61e-14 ***\nanime                     -3.480e+06  2.132e+06  -1.633 0.102740    \nglobal_revenue             6.134e-02  3.760e-03  16.314  < 2e-16 ***\nafter_2008                -1.073e+07  2.962e+06  -3.621 0.000303 ***\nregionJapan:after_2008    -2.817e+06  2.190e+06  -1.286 0.198646    \nanime:after_2008           1.195e+07  2.472e+06   4.833 1.47e-06 ***\nglobal_revenue:after_2008 -2.908e-02  4.117e-03  -7.065 2.37e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16130000 on 1644 degrees of freedom\n  (448 observations deleted due to missingness)\nMultiple R-squared:  0.3028,\tAdjusted R-squared:  0.2998 \nF-statistic:   102 on 7 and 1644 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nmodel2 <- lm(gross ~ region + anime + global_revenue + region*year_number + anime*year_number + global_revenue*year_number, data = ranking)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = gross ~ region + anime + global_revenue + region * \n    year_number + anime * year_number + global_revenue * year_number, \n    data = ranking)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-114531166   -7453650   -2267867    3285503  193355907 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                -1.091e+07  2.248e+06  -4.855 1.32e-06 ***\nregionJapan                 9.810e+06  1.619e+06   6.060 1.68e-09 ***\nanime                       1.059e+07  1.677e+06   6.315 3.47e-10 ***\nglobal_revenue              2.606e-02  2.272e-03  11.467  < 2e-16 ***\nyear_number                -8.003e+05  2.183e+05  -3.666 0.000254 ***\nregionJapan:year_number    -3.754e+05  1.592e+05  -2.358 0.018469 *  \nanime:year_number           6.918e+05  1.763e+05   3.925 9.03e-05 ***\nglobal_revenue:year_number -1.768e-03  2.614e-04  -6.762 1.88e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16060000 on 1644 degrees of freedom\n  (448 observations deleted due to missingness)\nMultiple R-squared:  0.3089,\tAdjusted R-squared:  0.3059 \nF-statistic:   105 on 7 and 1644 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}