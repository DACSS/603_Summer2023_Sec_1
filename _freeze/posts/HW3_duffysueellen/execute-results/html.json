{
  "hash": "0ed49d52dec5e7973d1e07baea31cf44",
  "result": {
    "markdown": "---\ntitle: \"HW3\"\nauthor: \"Sue-Ellen Duffy\"\ndate: \"06/27/2023\"\noutput: pdf_document\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(summarytools)\nlibrary(readxl)\nlibrary(stats)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n\n# 4.6 Exercises\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#1\n# create both vectors\ncs <- c(23, 19, 30, 22, 23, 29, 35, 36, 33, 25)\nts <- c(430, 430, 333, 410, 390, 377, 325, 310, 328, 375)\n\n# draw the scatterplot\nplot(cs, ts)\n```\n\n::: {.cell-output-display}\n![](HW3_duffysueellen_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#2\n# compute mean, variance and standard deviation of test scores\nmean(ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 370.8\n```\n:::\n\n```{.r .cell-code}\nvar(ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2002.844\n```\n:::\n\n```{.r .cell-code}\nsd(ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 44.75315\n```\n:::\n\n```{.r .cell-code}\n# compute the covariance and the correlation coefficient\ncov(cs, ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -251.4444\n```\n:::\n\n```{.r .cell-code}\ncor(cs, ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.9474424\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#3\n# attach the package AER\nlibrary(AER)\n\n# estimate the model\nmod <- lm(ts ~ cs)\nmod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs)\n\nCoefficients:\n(Intercept)           cs  \n     567.43        -7.15  \n```\n:::\n\n```{.r .cell-code}\n# obtain a model summary\nsummary(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.9248 -10.6002  -0.8506   5.8631  27.0246 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 567.4272    23.9606  23.682 1.08e-08 ***\ncs           -7.1501     0.8536  -8.376 3.13e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.19 on 8 degrees of freedom\nMultiple R-squared:  0.8976,\tAdjusted R-squared:  0.8849 \nF-statistic: 70.16 on 1 and 8 DF,  p-value: 3.132e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#4\nclass(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"lm\"\n```\n:::\n\n```{.r .cell-code}\nis.list(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nnames(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"xlevels\"       \"call\"          \"terms\"         \"model\"        \n```\n:::\n\n```{.r .cell-code}\nmod$model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    ts cs\n1  430 23\n2  430 19\n3  333 30\n4  410 22\n5  390 23\n6  377 29\n7  325 35\n8  310 36\n9  328 33\n10 375 25\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#5 ??\nplot(cs,ts)\nmod$residuals\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           1            2            3            4            5            6 \n 27.02464455  -1.57567141 -19.92480253  -0.12543444 -12.97535545  16.92511848 \n           7            8            9           10 \n  7.82559242  -0.02432859  -3.47456556 -13.67519747 \n```\n:::\n\n```{.r .cell-code}\nabline(mod)\n```\n\n::: {.cell-output-display}\n![](HW3_duffysueellen_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#6\ns <- summary(mod)\n\nnames(s)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"call\"          \"terms\"         \"residuals\"     \"coefficients\" \n [5] \"aliased\"       \"sigma\"         \"df\"            \"r.squared\"    \n [9] \"adj.r.squared\" \"fstatistic\"    \"cov.unscaled\" \n```\n:::\n\n```{.r .cell-code}\nR2 <- s$r.squared\nR2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8976472\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#7\ncoefs <- s$coefficients\ncoefs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 567.427172 23.9606448 23.681632 1.075914e-08\ncs           -7.150079  0.8536168 -8.376216 3.132287e-05\n```\n:::\n:::\n\n\n#8\n\n::: {.cell}\n\n```{.r .cell-code}\n#8\n#regress ts solely on cs. Store the results in mod_ni\n\nmod_ni <- lm(ts ~ cs + 0)\n```\n:::\n\n\n#9\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_ni)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs + 0)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-145.57  -78.87   34.32  123.43  189.56 \n\nCoefficients:\n   Estimate Std. Error t value Pr(>|t|)    \ncs    12.65       1.36   9.304  6.5e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 120.7 on 9 degrees of freedom\nMultiple R-squared:  0.9058,\tAdjusted R-squared:  0.8954 \nF-statistic: 86.57 on 1 and 9 DF,  p-value: 6.501e-06\n```\n:::\n\n```{.r .cell-code}\ncoef <- summary(mod_ni)$coefficients\n```\n:::\n\n\n#10\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(coef)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Estimate Std. Error  t value    Pr(>|t|)\ncs 12.65478    1.36013 9.304097 6.50056e-06\n```\n:::\n\n```{.r .cell-code}\n### I do not understand why it is coef [1,1]/coef[1,2]\n\nt_stat <- coef[1,1]/coef[1/2]\n```\n:::\n\nt_stat <- (mean()\n(mean(cps$ahe12)-23.5)/(sd(cps$ahe12)/sqrt(length(cps$ahe12)))\n\n#11\n\n::: {.cell}\n\n```{.r .cell-code}\n#11\n\nplot(cs, ts)\nabline(mod, col = \"blue\")\nabline(mod_ni, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](HW3_duffysueellen_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#12\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#12\nlinear_model <- lm(ts ~ cs)\nlinear_model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs)\n\nCoefficients:\n(Intercept)           cs  \n     567.43        -7.15  \n```\n:::\n\n```{.r .cell-code}\nmod_summary <- summary(linear_model)\nmod_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.9248 -10.6002  -0.8506   5.8631  27.0246 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 567.4272    23.9606  23.682 1.08e-08 ***\ncs           -7.1501     0.8536  -8.376 3.13e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.19 on 8 degrees of freedom\nMultiple R-squared:  0.8976,\tAdjusted R-squared:  0.8849 \nF-statistic: 70.16 on 1 and 8 DF,  p-value: 3.132e-05\n```\n:::\n\n```{.r .cell-code}\nSSR <- sum(mod_summary$residuals^2)\nSSR2 <- sum(mod$residuals^2)\nSSR3 <- sum(s$residuals^2)\nSSR\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1844.971\n```\n:::\n\n```{.r .cell-code}\nSSR2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1844.971\n```\n:::\n\n```{.r .cell-code}\nSSR3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1844.971\n```\n:::\n\n```{.r .cell-code}\nTSS <- sum((ts - mean(ts))^2)\nTSS2 <- 9*var(ts)\n## Note from hw: `var()` computes the unbiased sample variance! => correct for this by multiplying with (n-1) = 9\nTSS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18025.6\n```\n:::\n\n```{.r .cell-code}\nTSS2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18025.6\n```\n:::\n:::\n\n\n#13\n\n::: {.cell}\n\n```{.r .cell-code}\nR2 <- (1-(SSR/TSS))\nR2 <- round(R2, digits = 4)\nR2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8976\n```\n:::\n\n```{.r .cell-code}\nR2hw <- round(1-SSR/TSS,4)\nR2hw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8976\n```\n:::\n:::\n\n\n#14\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ts ~ cs)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.9248 -10.6002  -0.8506   5.8631  27.0246 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 567.4272    23.9606  23.682 1.08e-08 ***\ncs           -7.1501     0.8536  -8.376 3.13e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.19 on 8 degrees of freedom\nMultiple R-squared:  0.8976,\tAdjusted R-squared:  0.8849 \nF-statistic: 70.16 on 1 and 8 DF,  p-value: 3.132e-05\n```\n:::\n\n```{.r .cell-code}\nSER <- s$sigma\nSER\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 15.18622\n```\n:::\n\n```{.r .cell-code}\nSSR14 <- SER^2*(length(ts)-2)\nSSR14 == SSR\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n#15\n\n::: {.cell}\n\n```{.r .cell-code}\n#covariance matrix\ncov_matrix <- s$cov.unscaled\ncov_matrix  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            (Intercept)           cs\n(Intercept)  2.48941548 -0.086887836\ncs          -0.08688784  0.003159558\n```\n:::\n\n```{.r .cell-code}\n#standard errors\nSEs <- sqrt(diag(cov_matrix))\nSEs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)          cs \n 1.57778816  0.05620994 \n```\n:::\n:::\n",
    "supporting": [
      "HW3_duffysueellen_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}