{
  "hash": "78232a6d8b6ed66cb241ef4a8840f9f6",
  "result": {
    "markdown": "---\ntitle: \"Keith Martin Project 2\"\nauthor: \"Keith Martin\"\ndesription: \"Regression Analysis on Dispensary Licensing\"\ndate: \"08/17/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - project2\n  - dataset\n  - ggplot2\n  - regression\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(summarytools)\nlibrary(ggplot2)\nlibrary(magrittr)\nlibrary(car)\nlibrary(AER)\nlibrary(stargazer)\nlibrary(knitr)\nlibrary(broom)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Introduction\n\nThis dataset comprises information gathered from 387 applications submitted in Pennsylvania during 2016. These applications originated from various companies vying for licenses to operate dispensaries within the state.\n\nEach entry in the dataset represents a company, and occasionally, there are multiple applications from the same company. These applications are evaluated across 16 distinct categories. These categories encompass factors such as diversity plans, operational timetables, qualifications, security protocols, transportation, storage, labeling, inventory management, diversion prevention, sanitation, record-keeping, historical context, capital investment, community engagement, site planning, and personal identification.\n\nThe evaluation scores across these categories are aggregated to form a total score, which has a maximum value of 800. Theoretically, a higher total score correlates with an increased likelihood of obtaining a license. However, upon reviewing the data, it becomes apparent that the companies with the highest scores do not always secure licenses. Conversely, some companies with lower scores do receive licenses. Moreover, specific categories can influence licensing outcomes, allowing companies with lower overall scores but strong performance in key categories to succeed.\n\nThis analysis focuses on investigating various regression models to understand the impact of a company's capital score on their chances of obtaining a license. The legislative process emphasized prioritizing communities most adversely affected by the criminalization of Marijuana during the licensing allocation.\n\nThe analysis includes qualification scores as a variable. This enables a comparison between the significance of the diversity plan and qualification score. Qualification scores are also used to account for omitted variable bias.\n\nThe hypothesis is that capital will exhibit a statistically more significant relationship than the diversity plan in influencing the licensing outcome. Qualification is used as a quasi-control variable to assess whether the diversity plan's impact on outcomes holds when the company is otherwise qualified.\n\nIt is anticipated that diversity plan significance levels will be lower compared to capital. The hypothesis postulates that capital directly influences the outcome of obtaining a license.\n\n\n\n\n\n\n\n## Reading The Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPA_Dispensary_License_Data_tab <- read_excel(\"~/Downloads/PA Dispensary License Data.tab.xlsx\")\nhead(PA_Dispensary_License_Data_tab, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 22\n   phase dispens…¹ name  diver…² opera…³ quali…⁴ secur…⁵ trans…⁶ storage label…⁷\n   <dbl> <chr>     <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1     1 D-1001-17 BHS …      31    70.4    25.6    50.2    11.8    24.4    16.4\n 2     1 D-1003-17 Prim…      68    64.8    35.6    56.2    16      37.8    18.2\n 3     1 D-1004-17 Keen…      65    63.8    32.4    72.2    12.4    30.8    13.6\n 4     1 D-1006-17 Grow…      34    48      27.2    48.4    13      20.6    14.4\n 5     1 D-1007-17 Heal…      25    51.4    26.2    51.4    13.2    23.4    14.2\n 6     1 D-1009-17 Elem…      40    66      27.8    65.6    18.6    32.4    15.8\n 7     1 D-1010-17 420 …      60    29.6    21      32.6     9.6    16.2     9.6\n 8     1 D-1011-17 Pali…      38    48      31.6    56.8     6.2    26.4    16.6\n 9     1 D-1012-17 The …      32    24.8    29.2    56.4    15      26.2    14.6\n10     1 D-1013-17 Elem…      40    66.4    31.4    65.6    18      32.6    17.2\n# … with 12 more variables: inventory <dbl>, diversion <dbl>, sanitation <dbl>,\n#   recordkeeping <dbl>, history <dbl>, capital <dbl>, community <dbl>,\n#   siteplan <dbl>, personalid <dbl>, awarded <dbl>, licensed <dbl>,\n#   dispensaries <dbl>, and abbreviated variable names ¹​dispensarynumber,\n#   ²​diversityplan, ³​operationaltimetable, ⁴​qualifications, ⁵​security,\n#   ⁶​transportation, ⁷​labeling\n```\n:::\n:::\n\nThe data set includes various companies that applied for a dispensary license in 2016. There are 16 categories that are added up to a total score. The score is used to determine whether or not the company will receive a license to operate a dispensary. \n\n## Cleaning Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n PA_Dispensary_License_Condensed<-PA_Dispensary_License_Data_tab %>%\n      select(name, diversityplan, qualifications, security, capital,licensed, awarded)\nhead(PA_Dispensary_License_Condensed, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 7\n   name                          diver…¹ quali…² secur…³ capital licen…⁴ awarded\n   <chr>                           <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 BHS Wellness, LLC                  31    25.6    50.2    28.6       0    471 \n 2 Prime Wellness of Pennsylvan…      68    35.6    56.2    67.2       0    644 \n 3 Keen Meds, LLC                     65    32.4    72.2    59.2       0    608.\n 4 Grow Ventures Penn, LLC            34    27.2    48.4    53.6       0    468.\n 5 Healing Hope, LLC                  25    26.2    51.4    37.4       0    478.\n 6 Elemental Health Group, LLC        40    27.8    65.6    62.6       0    646.\n 7 420 Nature's Root                  60    21      32.6    41.2       0    396.\n 8 PaliaTech PA, LLC                  38    31.6    56.8    50         0    512.\n 9 The Natural Dispensary, LLC        32    29.2    56.4    51.8       0    492.\n10 Elemental Health Group, LLC        40    31.4    65.6    56.2       0    618.\n# … with abbreviated variable names ¹​diversityplan, ²​qualifications, ³​security,\n#   ⁴​licensed\n```\n:::\n:::\n\n\n## Regression Models\n\n::: {.cell}\n\n```{.r .cell-code}\n###original model\nlinear_model<-lm(licensed ~ capital, data = PA_Dispensary_License_Condensed)\n### original probit model\nmodel <- glm(licensed ~ capital, data = PA_Dispensary_License_Condensed, family = binomial(link=\"probit\"))\n###original logit model\nmodel_logit <- glm(licensed ~ capital, data = PA_Dispensary_License_Condensed, family = binomial(link=\"logit\"))\n###Probit Model Plus Diversity Plan Regressor\nmodel_diversity <- glm(licensed ~ capital + diversityplan, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\n###Probit Model with Qualification Regressor\nmodel_qualification <- glm (licensed ~ capital + qualifications, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\n\n###Probit Model With All Regressots\nmodel_all <- glm (licensed ~ capital + qualifications + diversityplan, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoefficients_df <-  suppressWarnings(bind_rows(\nmod1 =tidy(linear_model, conf.int = TRUE),\nmod2 =tidy(model, conf.int = TRUE),\nmod3 =tidy(model_logit, conf.int = TRUE),\nmod4 =tidy(model_diversity, conf.int = TRUE),\nmod5 =tidy(model_qualification, conf.int = TRUE),\nmod6 =tidy(model_all, conf.int=TRUE)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Print the coefficients table using kable\nkable(coefficients_df, caption = \"Regresssion Model Coefficient Results\")\n```\n\n::: {.cell-output-display}\nTable: Regresssion Model Coefficient Results\n\n|term           |    estimate| std.error| statistic|   p.value|    conf.low|  conf.high|\n|:--------------|-----------:|---------:|---------:|---------:|-----------:|----------:|\n|(Intercept)    |  -0.2442783| 0.0852046| -2.866962| 0.0044991|  -0.4120918| -0.0764647|\n|capital        |   0.0065795| 0.0015533|  4.235692| 0.0000321|   0.0035201|  0.0096388|\n|(Intercept)    |  -5.6223750| 1.1633523| -4.832909| 0.0000013|  -8.1829818| -3.5532529|\n|capital        |   0.0749624| 0.0190141|  3.942471| 0.0000806|   0.0407410|  0.1164120|\n|(Intercept)    | -10.3084100| 2.2333146| -4.615745| 0.0000039| -15.1612780| -6.4049083|\n|capital        |   0.1394364| 0.0359413|  3.879565| 0.0001046|   0.0756969|  0.2166748|\n|(Intercept)    |  -5.7371537| 1.1491234| -4.992635| 0.0000006|  -8.2816391| -3.6714647|\n|capital        |   0.0660720| 0.0194028|  3.405288| 0.0006609|   0.0308188|  0.1084331|\n|diversityplan  |   0.0138857| 0.0089170|  1.557214| 0.1194197|  -0.0038138|  0.0317270|\n|(Intercept)    |  -7.5834522| 1.4963448| -5.067984| 0.0000004| -10.8197982| -4.8749181|\n|capital        |   0.0577678| 0.0212039|  2.724394| 0.0064420|   0.0183242|  0.1026350|\n|qualifications |   0.0881670| 0.0317759|  2.774645| 0.0055262|   0.0279051|  0.1554821|\n|(Intercept)    |  -7.6813219| 1.4902407| -5.154417| 0.0000003| -10.9230486| -4.9693986|\n|capital        |   0.0496580| 0.0217109|  2.287239| 0.0221819|   0.0093499|  0.0954759|\n|qualifications |   0.0874564| 0.0324421|  2.695768| 0.0070227|   0.0260376|  0.1556713|\n|diversityplan  |   0.0130037| 0.0094610|  1.374459| 0.1692991|  -0.0056912|  0.0318210|\n:::\n:::\n\n\nI have included the results of the regression analysis above. I will continue with the analysis in the below setions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List of variables you want to summarize\nvars_to_summarize <- c(\"capital\", \"diversityplan\", \"qualifications\")\n\n# Initialize an empty data frame to store the results\nsummary_table <- data.frame()\n\n# Loop through each variable and calculate summary statistics\nfor (var in vars_to_summarize) {\n  summary_row <- data.frame(\n    Metric = c(paste0(\"sd_\", var), paste0(\"max_\", var), paste0(\"min_\", var), paste0(\"avg_\", var), paste0(\"med_\", var), paste0(\"n_\", var)),\n    Value = c(sd(PA_Dispensary_License_Condensed[[var]], na.rm = TRUE),\n               max(PA_Dispensary_License_Condensed[[var]], na.rm = TRUE),\n               min(PA_Dispensary_License_Condensed[[var]], na.rm = TRUE),\n               mean(PA_Dispensary_License_Condensed[[var]], na.rm = TRUE),\n               median(PA_Dispensary_License_Condensed[[var]], na.rm = TRUE),\n               sum(!is.na(PA_Dispensary_License_Condensed[[var]])))  # Count non-NA values\n  )\n  \n  # Append the summary_row to the summary_table using rbind()\n  summary_table <- rbind(summary_table, summary_row)\n}\n\n# Print the resulting summary_table\nprint(summary_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Metric      Value\n1          sd_capital  12.232781\n2         max_capital  72.600000\n3         min_capital  10.200000\n4         avg_capital  53.476693\n5         med_capital  57.330000\n6           n_capital 251.000000\n7    sd_diversityplan  15.354646\n8   max_diversityplan  75.000000\n9   min_diversityplan   5.000000\n10  avg_diversityplan  44.917313\n11  med_diversityplan  45.000000\n12    n_diversityplan 387.000000\n13  sd_qualifications   6.101741\n14 max_qualifications  45.000000\n15 min_qualifications   8.200000\n16 avg_qualifications  30.757080\n17 med_qualifications  31.600000\n18   n_qualifications 387.000000\n```\n:::\n:::\n\nAdditionally, I have included the summary statistics above. As the table shows, diversity plan has a slightly larger variation in standard deviation when compared to the other two variables. The summary statistics provide the background for the below regression analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_model<-lm(licensed ~ capital, data = PA_Dispensary_License_Condensed)\n\nsummary(linear_model)$coefficient\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) -0.244278261 0.085204568 -2.866962 4.499059e-03\ncapital      0.006579464 0.001553339  4.235692 3.209303e-05\n```\n:::\n\n```{.r .cell-code}\n### Have to plot it differently\n\nplot(PA_Dispensary_License_Condensed$capital, PA_Dispensary_License_Condensed$licensed, main = \"Regression Results\", xlab = \"X\", ylab = \"Y\")\nabline(linear_model, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](KeithMartin_Project2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nIn summary, a T-value of 4.235692 for the independent variable capital in a simple regression with the dependent variable licensed indicates a strong relationship between the variables, and the relationship is statistically significant based on the chosen level of significance. In this case, the p-value is extremely small and less than one 1%. The chosen level of significance for this case would be P<.05. More specifically, if the p-value is below the predetermined significance level, it suggests that the probability of observing the results under the null hypothesis are very low. In such cases, it is generally concluded that there is a statistically significant relationship in the data.\n\nFor each unit increase in the capital variable, there is an estimated increase of approximately 0.006579464 in the probability or likelihood of the licensed variable being equal to 1, assuming all other factors are held constant.\n\nIn plain English, this means that as the capital variable increases, the estimated effect is a slight increase in the probability of having a value of 1 for the licensed variable. However, since the coefficient is very small (0.006579464), the practical significance of this effect may be limited.\n\nSince the dependent variable is a dummy (binary) variable, the regression line does not fit that nicely on the plot. I did some additional research and found that a curve is more fitting for this type of variable. \n## Regression Analysis With Binary Variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Regression Graph for Dummy Dependent Variable\n\nmodel <- glm(licensed ~ capital, data = PA_Dispensary_License_Condensed, family = binomial)\nplot(PA_Dispensary_License_Condensed$capital, PA_Dispensary_License_Condensed$licensed, main = \"Regression Plot of Licensed vs. Capital\", xlab = \"Capital\", ylab = \"Licensed\")\n### This code adds a curve instead of a standard line(abline) for regression of dummy dependent variables\ncurve(predict(model, data.frame(capital = x), type = \"response\"), add = TRUE, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](KeithMartin_Project2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIn the above plot, I used a general linear model to predict the curve of the dummy variable. This is a much cleaner plot that the original regression line above. This more closely illustrates the relationship between capital score and licensing outcome.\n\n# Multivariate Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Original Model Probit\nmodel <- glm(licensed ~ capital, data = PA_Dispensary_License_Condensed, family = binomial(link=\"probit\"))\n\ncoeftest(model, vcov. = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nz test of coefficients:\n\n             Estimate Std. Error z value  Pr(>|z|)    \n(Intercept) -5.622375   0.930207 -6.0442 1.501e-09 ***\ncapital      0.074962   0.015349  4.8839 1.040e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nP(License|Capital) = Φ(-5.62 +.075Capital Score)\n\nIn the context of the provided results, where \"capital\" is listed as an independent variable with a significant coefficient estimate, it suggests that there is a statistically meaningful relationship between the \"capital\" variable and the dependent variable being analyzed. The analysis indicates that changes in the \"capital\" variable are associated with changes in the outcome of interest.\n\nSince the coefficient estimate for \"capital\" is positive (approximately 0.074962), it implies that an increase in the value of the \"capital\" variable is associated with an increase in the value of the dependent variable, licensed, all else being equal. In other words, there is a positive correlation between the \"capital\" variable and the licensing outcome being studied.\n\nThe fact that the coefficient for \"capital\" is statistically significant (indicated by the low p-value) suggests that this relationship is unlikely to be due to random chance. It's important to note that statistical significance does not necessarily imply a causal relationship; it only indicates that there is a strong association between the two variables in the analyzed data.\n\nWithout more specific context about the nature of the variables and the analysis being conducted, it's challenging to provide a precise interpretation of how \"capital\" relates to \"license.\" However, based on the information provided, it can be inferred that higher values of the \"capital\" variable are predictive of higher values of the dependent variable, and this relationship is supported by the statistical analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(x = PA_Dispensary_License_Condensed$capital,\n     y = PA_Dispensary_License_Condensed$licensed,\n     main = \"Scatterplot Dispensary Application Approval and \n                                    the Capital\",\n     xlab = \"Capital Score\",\n     ylab = \"License Result\",\n     pch = 20,\n     ylim = c(-0.4, 1.4),\n     cex.main = 0.8)\n# add horizontal dashed lines and text\nabline(h = 1, lty = 2, col = \"darkred\")\nabline(h = 0, lty = 2, col = \"darkred\")\ntext(20, 0.9, cex = 0.8, \"License Approved\")\ntext(20, -0.1, cex= 0.8, \"License Denied\")\n### add a regression line\nx <- seq(0, 70, 10)\ny <- predict(model, list(capital = x), type = \"response\")\n\nlines(x, y, lwd = 1.5, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](KeithMartin_Project2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nThe above graph shows that the probit model is similar to general linear model above.  This is particularly useful when the relationship between the independent variables(Captial) and the probability of the binary outcome occurring is not linear, but rather follows a cumulative distribution function (CDF), specifically the cumulative normal distribution function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Predictions with Capital 60 to 70\nnew_data <- data.frame(capital = c(60, 70))  # Create a data frame with the 'capital' values you want to predict for\npredictions <- predict(model, newdata = new_data, type = \"response\")  # Use \"response\" for binary outcome prediction\n\ndiff(predictions)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        2 \n0.2234556 \n```\n:::\n:::\n\n\nWe find that an increase in the capital score from  60 to  70 is predicted to increase the probability of denial by approximately 22.3% This further supports the initial hypothesis that an increase in the capital score increases the chances of a compoany receiving a dispensary license. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Original Model Logit\nmodel_logit <- glm(licensed ~ capital, data = PA_Dispensary_License_Condensed, family = binomial(link=\"logit\"))\n\ncoeftest(model_logit, vcov. = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nz test of coefficients:\n\n              Estimate Std. Error z value  Pr(>|z|)    \n(Intercept) -10.308410   1.844778 -5.5879 2.299e-08 ***\ncapital       0.139436   0.029845  4.6720 2.983e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nP(Licensed = 1| Capital) = F(-10.3 + .13Capital)\n\nIntercept (Constant Term):\n\nEstimate: The estimated intercept (constant term) is -10.308410.\nStd. Error: The standard error associated with the intercept estimate is 1.844778.\n\nz value: The calculated z value for the intercept is -5.5879.\nPr(>|z|): The p-value associated with the z value is extremely small (2.299e-08), indicating that the intercept is statistically significant. This suggests that the log-odds of the outcome being \"licensed\" are significantly different from zero.\nCapital:\n\nEstimate: The estimated coefficient for the variable \"capital\" is 0.139436.\n\nStd. Error: The standard error associated with the coefficient estimate is 0.029845.\n\nz value: The calculated z value for the coefficient is 4.6720.\nPr(>|z|): The p-value associated with the z value is very small (2.983e-06), indicating that the \"capital\" variable is statistically significant. This suggests that for a one-unit increase in the \"capital\" variable, the log-odds of the outcome being \"licensed\" increases by 0.139436 units.\n\nThe \"Signif. codes\" section provides a quick interpretation of the significance levels:\n\nIn summary, based on this logistic regression model, there is strong evidence to suggest that the \"capital\" variable significantly influences the likelihood of being \"licensed,\" while the intercept (constant term) also plays a significant role in predicting the outcome.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Plot Logit Regression\nplot(x = PA_Dispensary_License_Condensed$capital,\n     y = PA_Dispensary_License_Condensed$licensed,\n     main = \"Scatterplot Dispensary Application Approval and \n                                    the Capital\",\n     xlab = \"Capital Score\",\n     ylab = \"License Result\",\n     pch = 20,\n     ylim = c(-0.4, 1.4),\n     cex.main = 0.8)\n# add horizontal dashed lines and text\nabline(h = 1, lty = 2, col = \"darkred\")\nabline(h = 0, lty = 2, col = \"darkred\")\ntext(60, 0.9, cex = 0.8, \"License Approved\")\ntext(20, -0.1, cex= 0.8, \"License Denied\")\n### add a regression line\nx <- seq(0, 70, 10)\ny_probit <- predict(model, list(capital = x), type = \"response\")\ny_logit <- predict(model, list(capital = x), type = \"response\")\n### Add both regression Lines\nlines(x, y_probit, lwd = 1.5, col = \"steelblue\")\nlines(x, y_logit, lwd = 1.5, col = \"black\", lty = 2)\n###Legend\nlegend(\"topleft\",\n       horiz = TRUE,\n       legend = c(\"Probit\", \"Logit\"),\n       col = c(\"steelblue\", \"black\"), \n       lty = c(5, 2))\n```\n\n::: {.cell-output-display}\n![](KeithMartin_Project2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAs you can see from the above model, the logit and probit model are almost the exact same. A logit model, also known as a logistic regression model, is a statistical method used to model the relationship between one or more independent variables and a binary dependent variable. In a logistic regression, the coefficients β are estimated using maximum likelihood estimation. These coefficients provide information about the direction and strength of the relationship between each predictor variable and the probability of the binary outcome occurring. In the below analysis, I will discuss the specific values of the logit model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Multi-Variate Model with Diversity\nmodel_diversity <- glm(licensed ~ capital + diversityplan, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\n\ncoeftest(model_diversity, vcov. = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nz test of coefficients:\n\n               Estimate Std. Error z value  Pr(>|z|)    \n(Intercept)   -5.737154   0.858463 -6.6831 2.340e-11 ***\ncapital        0.066072   0.015441  4.2791 1.877e-05 ***\ndiversityplan  0.013886   0.008202  1.6930   0.09046 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlinearHypothesis(model_diversity, c(\"capital=0\", \"diversityplan=0\"), white.adjust = \"hc1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\ncapital = 0\ndiversityplan = 0\n\nModel 1: restricted model\nModel 2: licensed ~ capital + diversityplan\n\n  Res.Df Df  Chisq Pr(>Chisq)    \n1    250                         \n2    248  2 18.124   0.000116 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\nP(License|Capital+Diversityplan) = Φ(-5.62 +.066Capital Score +.013Diversityplan) ** Not statistically significant in Diversity Plan\n\nz Test of Coefficients:\n\n(Intercept) coefficient: The coefficient for the intercept is -5.737154. The corresponding standard error is 0.858463. The z value (coefficient divided by its standard error) is -6.6831. The p-value associated with this z value is extremely small (2.340e-11), indicated by '***', suggesting that the intercept is significantly different from zero.\ncapital coefficient: The coefficient for the capital predictor variable is 0.066072. The standard error is 0.015441. The z value is 4.2791, and the p-value is also very small (1.877e-05), '***', indicating that the capital predictor is statistically significant.\ndiversityplan coefficient: The coefficient for the diversityplan predictor is 0.013886, and its standard error is 0.008202. The z value is 1.6930, and the associated p-value is 0.09046, indicated by a '.'. This suggests that the diversityplan predictor is not statistically significant at the conventional significance levels (alpha = 0.05).\nLinear Hypothesis Test:\nThe linear hypothesis test is evaluating the joint significance of the capital and diversityplan predictors by comparing two models:\n\nModel 1: Restricted model without capital and diversityplan.\nModel 2: Full model with capital and diversityplan.\nThe test statistic (Chi-square) is 18.124 with 2 degrees of freedom. The p-value associated with this test statistic is 0.000116, '***', indicating strong evidence to reject the null hypothesis. This suggests that the joint inclusion of capital and diversityplan significantly improves the fit of the model compared to a model without these predictors.\n\nIn summary, the z test of coefficients indicates that the intercept and the capital predictor are both statistically significant. The diversityplan predictor, although not statistically significant by itself, contributes to the overall model fit in the linear hypothesis test when combined with the capital predictor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### general linear model with qualifications\nmodel_qualification <- glm (licensed ~ capital + qualifications, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\ncoeftest(model_qualification, vcov. = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nz test of coefficients:\n\n                Estimate Std. Error z value  Pr(>|z|)    \n(Intercept)    -7.583452   1.223928 -6.1960 5.792e-10 ***\ncapital         0.057768   0.018528  3.1179 0.0018217 ** \nqualifications  0.088167   0.025949  3.3977 0.0006795 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlinearHypothesis(model_qualification, c(\"capital=0\", \"qualifications=0\"), white.adjust = \"hc1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\ncapital = 0\nqualifications = 0\n\nModel 1: restricted model\nModel 2: licensed ~ capital + qualifications\n\n  Res.Df Df  Chisq Pr(>Chisq)    \n1    250                         \n2    248  2 19.719  5.225e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\nP(License|Capital+Qualification) = Φ(-5.62 +.057Capital Score +.088Qualification)\n\nZ Test of Coefficients:\n\nIntercept: The coefficient for the intercept is -7.583452. This represents the expected log-odds of the licensed variable when both capital and qualifications are zero. The negative coefficient suggests that as the predictor values increase, the log-odds of being licensed decrease.\n\ncapital: The coefficient for the capital predictor is 0.057768. It is statistically significant as indicated by the '**' symbol. This means that a unit increase in capital is associated with a 0.057768 increase in the log-odds of being licensed, holding other variables constant.\n\nqualifications: The coefficient for the qualifications predictor is 0.088167. It is statistically significant ('***'), indicating that a unit increase in qualifications is associated with a 0.088167 increase in the log-odds of being licensed, holding other variables constant.\n\nLinear Hypothesis Test:\nThe linear hypothesis test evaluates the joint significance of capital and qualifications in the model:\n\nModel 1: Restricted model without capital and qualifications.\nModel 2: Full model with capital and qualifications.\nThe test statistic (Chi-square) is 19.719, and the associated p-value is 5.225e-05 ('***'). This p-value is much smaller than the significance level of 0.05, indicating strong evidence to reject the null hypothesis. This suggests that including both capital and qualifications significantly improves the model's fit compared to a model without these predictors.\n\nIn summary, both capital and qualifications are individually significant predictors. Additionally, the linear hypothesis test indicates that the joint inclusion of these predictors significantly enhances the model's performance, further supporting their importance in explaining the variability in the response variable licensed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### general linear model with all variables \nmodel_all <- glm (licensed ~ capital + qualifications + diversityplan, data = PA_Dispensary_License_Condensed, family = binomial(link = \"probit\"))\n###CoefTest\ncoeftest(model_all, vcov. = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nz test of coefficients:\n\n                 Estimate Std. Error z value  Pr(>|z|)    \n(Intercept)    -7.6813219  1.1612710 -6.6146 3.726e-11 ***\ncapital         0.0496580  0.0195072  2.5456   0.01091 *  \nqualifications  0.0874564  0.0276150  3.1670   0.00154 ** \ndiversityplan   0.0130037  0.0090475  1.4373   0.15064    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n###Linear Hypothesis\nlinearHypothesis(model_all, c(\"capital=0\",\"diversityplan = 0\", \"qualifications=0\"), white.adjust = \"hc1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\ncapital = 0\ndiversityplan = 0\nqualifications = 0\n\nModel 1: restricted model\nModel 2: licensed ~ capital + qualifications + diversityplan\n\n  Res.Df Df  Chisq Pr(>Chisq)    \n1    250                         \n2    247  3 21.313  9.064e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nIn this case:\n\nThe intercept has a significantly negative coefficient, indicating that when all predictor variables are zero, the log-odds of being licensed is significantly negative.\ncapital has a positive coefficient with a p-value of 0.01091, which is less than 0.05. This suggests that an increase in capital is associated with a higher likelihood of being licensed.\n\nQualifications has a positive coefficient with a p-value of 0.00154, which is less than 0.05. This suggests that higher qualifications are associated with a higher likelihood of being licensed.\n\nDiversityplan has a positive coefficient, but its p-value (0.15064) is greater than 0.05. This suggests that diversityplan might not be statistically significant in predicting licensing status.\n\nLinear Hypothesis Test:\nThe linearHypothesis function tests the joint significance of multiple coefficients by comparing a restricted model (where those coefficients are restricted to zero) to the full model.\n\nIn this case:\nThe null hypothesis is that all three coefficients (capital, diversityplan, and qualifications) are simultaneously equal to zero.\n\nThe p-value associated with the hypothesis test (9.064e-05) is less than 0.05, indicating that at least one of these coefficients is significantly different from zero when considered together.\n\nThis suggests that at least one of these three variables (capital, diversityplan, qualifications) is important for predicting the licensing status when all three are considered together.\n\nThe significance tests like these provide insights into whether the coefficients are likely different from zero, but they do not provide information about the strength or practical importance of these effects.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrob_se<- list(sqrt(diag(vcovHC(linear_model, type = \"HC1\"))),\n               sqrt(diag(vcovHC(model, type = \"HC1\"))),\n               sqrt(diag(vcovHC(model_logit, type = \"HC1\"))),\n               sqrt(diag(vcovHC(model_diversity, type = \"HC1\"))),\n               sqrt(diag(vcovHC(model_qualification, type = \"HC1\"))),\n               sqrt(diag(vcovHC(model_all, type = \"HC1\"))))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_list <- list(linear_model,model,model_logit,model_diversity,  model_qualification, model_all) \n```\n:::\n\n\n```{.r .cell-code}\nstargazer(mod_list,  \n          digits = 3,\n          type = \"html\", \n          header = FALSE,\n          se = rob_se,\n          model.numbers = FALSE,\n          column.labels = c(\"(1)\", \"(2)\", \"(3)\", \"(4)\", \"(5)\", \"(6)\"))\n```\n\n\n<table style=\"text-align:center\"><tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"></td><td colspan=\"6\"><em>Dependent variable:</em></td></tr>\n<tr><td></td><td colspan=\"6\" style=\"border-bottom: 1px solid black\"></td></tr>\n<tr><td style=\"text-align:left\"></td><td colspan=\"6\">licensed</td></tr>\n<tr><td style=\"text-align:left\"></td><td><em>OLS</em></td><td><em>probit</em></td><td><em>logistic</em></td><td colspan=\"3\"><em>probit</em></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td><td>(5)</td><td>(6)</td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">capital</td><td>0.007<sup>***</sup></td><td>0.075<sup>***</sup></td><td>0.139<sup>***</sup></td><td>0.066<sup>***</sup></td><td>0.058<sup>***</sup></td><td>0.050<sup>**</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.001)</td><td>(0.015)</td><td>(0.030)</td><td>(0.015)</td><td>(0.019)</td><td>(0.020)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">diversityplan</td><td></td><td></td><td></td><td>0.014<sup>*</sup></td><td></td><td>0.013</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td>(0.008)</td><td></td><td>(0.009)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">qualifications</td><td></td><td></td><td></td><td></td><td>0.088<sup>***</sup></td><td>0.087<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td>(0.026)</td><td>(0.028)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Constant</td><td>-0.244<sup>***</sup></td><td>-5.622<sup>***</sup></td><td>-10.308<sup>***</sup></td><td>-5.737<sup>***</sup></td><td>-7.583<sup>***</sup></td><td>-7.681<sup>***</sup></td></tr>\n<tr><td style=\"text-align:left\"></td><td>(0.056)</td><td>(0.930)</td><td>(1.845)</td><td>(0.858)</td><td>(1.224)</td><td>(1.161)</td></tr>\n<tr><td style=\"text-align:left\"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\">Observations</td><td>251</td><td>251</td><td>251</td><td>251</td><td>251</td><td>251</td></tr>\n<tr><td style=\"text-align:left\">R<sup>2</sup></td><td>0.067</td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Adjusted R<sup>2</sup></td><td>0.063</td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">Log Likelihood</td><td></td><td>-72.585</td><td>-72.951</td><td>-71.402</td><td>-68.254</td><td>-67.323</td></tr>\n<tr><td style=\"text-align:left\">Akaike Inf. Crit.</td><td></td><td>149.170</td><td>149.902</td><td>148.805</td><td>142.508</td><td>142.647</td></tr>\n<tr><td style=\"text-align:left\">Residual Std. Error</td><td>0.300 (df = 249)</td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td style=\"text-align:left\">F Statistic</td><td>17.941<sup>***</sup> (df = 1; 249)</td><td></td><td></td><td></td><td></td><td></td></tr>\n<tr><td colspan=\"7\" style=\"border-bottom: 1px solid black\"></td></tr><tr><td style=\"text-align:left\"><em>Note:</em></td><td colspan=\"6\" style=\"text-align:right\"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>\n</table>\n\n\nOLS (Ordinary Least Squares):\n\nOLS assumes that the dependent variable is continuous and normally distributed.\nR-squared indicates the proportion of variance explained by the model. A relatively low R-squared (0.067) suggests that the linear relationship might not capture all the complexities of the data.\nSince the dependent variable \"licensed\" is likely binary (indicating presence or absence), OLS might not be the most suitable choice.\n\nProbit Models (Two Instances):\n\nProbit models are used for binary outcomes, assuming that the latent variable follows a normal distribution.\nLog Likelihood values (-72.951 and -68.254) suggest that these models fit the data relatively well, but a lower value is preferred.\nAIC values (149.902 and 142.508) indicate that the second probit model has a better balance between fit and complexity compared to the first one.\nProbit models provide probabilities of being \"licensed,\" assuming a normal distribution of the underlying latent variable.\n\nLogistic (Logit) Model:\n\nLogistic models are widely used for binary outcomes, assuming a logistic distribution of the latent variable.\nThe log-likelihood value (-71.402) suggests a reasonably good fit to the data.\n\nThe AIC value (148.805) indicates that the logistic model provides a balance between model fit and complexity.\nLogistic models provide probabilities of being \"licensed\" that are bounded between 0 and 1.\n\nIn summary, the findings align with the previously stated hypothesis, indicating that the diversity plan score bears lesser importance in comparison to both capital and qualification scores. This outcome presents a contradiction to the initial aim of fostering social equity. While the diversity plan does exert some impact on the overall model, its statistical significance pales when contrasted with the other variables.",
    "supporting": [
      "KeithMartin_Project2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}